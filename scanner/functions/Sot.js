function Sot(n,t,e){let i=e.isWebGL2;function r(){let Q=!1,Vt=new Re,Dt=null,te=new Re(0,0,0,0);return{setMask:function(xt){Dt!==xt&&!Q&&(n.colorMask(xt,xt,xt,xt),Dt=xt)},setLocked:function(xt){Q=xt},setClear:function(xt,jt,xe,Ue,di){di===!0&&(xt*=Ue,jt*=Ue,xe*=Ue),Vt.set(xt,jt,xe,Ue),te.equals(Vt)===!1&&(n.clearColor(xt,jt,xe,Ue),te.copy(Vt))},reset:function(){Q=!1,Dt=null,te.set(-1,0,0,0)}}}function o(){let Q=!1,Vt=null,Dt=null,te=null;return{setTest:function(xt){xt?q(2929):et(2929)},setMask:function(xt){Vt!==xt&&!Q&&(n.depthMask(xt),Vt=xt)},setFunc:function(xt){if(Dt!==xt){if(xt)switch(xt){case htt:n.depthFunc(512);break;case ptt:n.depthFunc(519);break;case dtt:n.depthFunc(513);break;case fS:n.depthFunc(515);break;case ftt:n.depthFunc(514);break;case mtt:n.depthFunc(518);break;case gtt:n.depthFunc(516);break;case xtt:n.depthFunc(517);break;default:n.depthFunc(515)}else n.depthFunc(515);Dt=xt}},setLocked:function(xt){Q=xt},setClear:function(xt){te!==xt&&(n.clearDepth(xt),te=xt)},reset:function(){Q=!1,Vt=null,Dt=null,te=null}}}function s(){let Q=!1,Vt=null,Dt=null,te=null,xt=null,jt=null,xe=null,Ue=null,di=null;return{setTest:function(Ge){Q||(Ge?q(2960):et(2960))},setMask:function(Ge){Vt!==Ge&&!Q&&(n.stencilMask(Ge),Vt=Ge)},setFunc:function(Ge,lr,Ur){(Dt!==Ge||te!==lr||xt!==Ur)&&(n.stencilFunc(Ge,lr,Ur),Dt=Ge,te=lr,xt=Ur)},setOp:function(Ge,lr,Ur){(jt!==Ge||xe!==lr||Ue!==Ur)&&(n.stencilOp(Ge,lr,Ur),jt=Ge,xe=lr,Ue=Ur)},setLocked:function(Ge){Q=Ge},setClear:function(Ge){di!==Ge&&(n.clearStencil(Ge),di=Ge)},reset:function(){Q=!1,Vt=null,Dt=null,te=null,xt=null,jt=null,xe=null,Ue=null,di=null}}}let a=new r,l=new o,c=new s,u={},h={},p=new WeakMap,d=[],f=null,m=!1,x=null,g=null,v=null,b=null,y=null,_=null,S=null,E=!1,M=null,P=null,D=null,w=null,I=null,N=n.getParameter(35661),L=!1,O=0,z=n.getParameter(7938);z.indexOf("WebGL")!==-1?(O=parseFloat(/^WebGL (\d)/.exec(z)[1]),L=O>=1):z.indexOf("OpenGL ES")!==-1&&(O=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),L=O>=2);let V=null,$={},X=n.getParameter(3088),W=n.getParameter(2978),K=new Re().fromArray(X),Z=new Re().fromArray(W);function Y(Q,Vt,Dt){let te=new Uint8Array(4),xt=n.createTexture();n.bindTexture(Q,xt),n.texParameteri(Q,10241,9728),n.texParameteri(Q,10240,9728);for(let jt=0;jt<Dt;jt++)n.texImage2D(Vt+jt,0,6408,1,1,0,6408,5121,te);return xt}let tt={};tt[3553]=Y(3553,3553,1),tt[34067]=Y(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),q(2929),l.setFunc(fS),ct(!1),bt(QL),q(2884),rt(rs);function q(Q){u[Q]!==!0&&(n.enable(Q),u[Q]=!0)}function et(Q){u[Q]!==!1&&(n.disable(Q),u[Q]=!1)}function it(Q,Vt){return h[Q]!==Vt?(n.bindFramebuffer(Q,Vt),h[Q]=Vt,i&&(Q===36009&&(h[36160]=Vt),Q===36160&&(h[36009]=Vt)),!0):!1}function at(Q,Vt){let Dt=d,te=!1;if(Q)if(Dt=p.get(Vt),Dt===void 0&&(Dt=[],p.set(Vt,Dt)),Q.isWebGLMultipleRenderTargets){let xt=Q.texture;if(Dt.length!==xt.length||Dt[0]!==36064){for(let jt=0,xe=xt.length;jt<xe;jt++)Dt[jt]=36064+jt;Dt.length=xt.length,te=!0}}else Dt[0]!==36064&&(Dt[0]=36064,te=!0);else Dt[0]!==1029&&(Dt[0]=1029,te=!0);te&&(e.isWebGL2?n.drawBuffers(Dt):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(Dt))}function nt(Q){return f!==Q?(n.useProgram(Q),f=Q,!0):!1}let _t={[Pc]:32774,[ttt]:32778,[ett]:32779};if(i)_t[iD]=32775,_t[rD]=32776;else{let Q=t.get("EXT_blend_minmax");Q!==null&&(_t[iD]=Q.MIN_EXT,_t[rD]=Q.MAX_EXT)}let vt={[ntt]:0,[itt]:1,[rtt]:768,[zz]:770,[utt]:776,[ltt]:774,[stt]:772,[ott]:769,[Fz]:771,[ctt]:775,[att]:773};function rt(Q,Vt,Dt,te,xt,jt,xe,Ue){if(Q===rs){m===!0&&(et(3042),m=!1);return}if(m===!1&&(q(3042),m=!0),Q!==QQ){if(Q!==x||Ue!==E){if((g!==Pc||y!==Pc)&&(n.blendEquation(32774),g=Pc,y=Pc),Ue)switch(Q){case os:n.blendFuncSeparate(1,771,1,771);break;case tD:n.blendFunc(1,1);break;case eD:n.blendFuncSeparate(0,769,0,1);break;case nD:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}else switch(Q){case os:n.blendFuncSeparate(770,771,1,771);break;case tD:n.blendFunc(770,1);break;case eD:n.blendFuncSeparate(0,769,0,1);break;case nD:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}v=null,b=null,_=null,S=null,x=Q,E=Ue}return}xt=xt||Vt,jt=jt||Dt,xe=xe||te,(Vt!==g||xt!==y)&&(n.blendEquationSeparate(_t[Vt],_t[xt]),g=Vt,y=xt),(Dt!==v||te!==b||jt!==_||xe!==S)&&(n.blendFuncSeparate(vt[Dt],vt[te],vt[jt],vt[xe]),v=Dt,b=te,_=jt,S=xe),x=Q,E=null}function yt(Q,Vt){Q.side===Vc?et(2884):q(2884);let Dt=Q.side===vn;Vt&&(Dt=!Dt),ct(Dt),Q.blending===os&&Q.transparent===!1?rt(rs):rt(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst,Q.blendEquationAlpha,Q.blendSrcAlpha,Q.blendDstAlpha,Q.premultipliedAlpha),l.setFunc(Q.depthFunc),l.setTest(Q.depthTest),l.setMask(Q.depthWrite),a.setMask(Q.colorWrite);let te=Q.stencilWrite;c.setTest(te),te&&(c.setMask(Q.stencilWriteMask),c.setFunc(Q.stencilFunc,Q.stencilRef,Q.stencilFuncMask),c.setOp(Q.stencilFail,Q.stencilZFail,Q.stencilZPass)),Rt(Q.polygonOffset,Q.polygonOffsetFactor,Q.polygonOffsetUnits),Q.alphaToCoverage===!0?q(32926):et(32926)}function ct(Q){M!==Q&&(Q?n.frontFace(2304):n.frontFace(2305),M=Q)}function bt(Q){Q!==YQ?(q(2884),Q!==P&&(Q===QL?n.cullFace(1029):Q===ZQ?n.cullFace(1028):n.cullFace(1032))):et(2884),P=Q}function gt(Q){Q!==D&&(L&&n.lineWidth(Q),D=Q)}function Rt(Q,Vt,Dt){Q?(q(32823),(w!==Vt||I!==Dt)&&(n.polygonOffset(Vt,Dt),w=Vt,I=Dt)):et(32823)}function Lt(Q){Q?q(3089):et(3089)}function Yt(Q){Q===void 0&&(Q=33984+N-1),V!==Q&&(n.activeTexture(Q),V=Q)}function Zt(Q,Vt){V===null&&Yt();let Dt=$[V];Dt===void 0&&(Dt={type:void 0,texture:void 0},$[V]=Dt),(Dt.type!==Q||Dt.texture!==Vt)&&(n.bindTexture(Q,Vt||tt[Q]),Dt.type=Q,Dt.texture=Vt)}function ne(){let Q=$[V];Q!==void 0&&Q.type!==void 0&&(n.bindTexture(Q.type,null),Q.type=void 0,Q.texture=void 0)}function G(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function H(){try{n.texSubImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function ht(){try{n.texSubImage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function kt(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Bt(){try{n.texStorage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function ft(){try{n.texStorage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Ht(){try{n.texImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function J(){try{n.texImage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function mt(Q){K.equals(Q)===!1&&(n.scissor(Q.x,Q.y,Q.z,Q.w),K.copy(Q))}function It(Q){Z.equals(Q)===!1&&(n.viewport(Q.x,Q.y,Q.z,Q.w),Z.copy(Q))}function Wt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),i===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},V=null,$={},h={},p=new WeakMap,d=[],f=null,m=!1,x=null,g=null,v=null,b=null,y=null,_=null,S=null,E=!1,M=null,P=null,D=null,w=null,I=null,K.set(0,0,n.canvas.width,n.canvas.height),Z.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:q,disable:et,bindFramebuffer:it,drawBuffers:at,useProgram:nt,setBlending:rt,setMaterial:yt,setFlipSided:ct,setCullFace:bt,setLineWidth:gt,setPolygonOffset:Rt,setScissorTest:Lt,activeTexture:Yt,bindTexture:Zt,unbindTexture:ne,compressedTexImage2D:G,texImage2D:Ht,texImage3D:J,texStorage2D:Bt,texStorage3D:ft,texSubImage2D:H,texSubImage3D:ht,compressedTexSubImage2D:kt,scissor:mt,viewport:It,reset:Wt}}