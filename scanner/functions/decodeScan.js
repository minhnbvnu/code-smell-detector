function decodeScan(t,r,o,y,m,v,w,_,k){var S=arguments.length>9&&void 0!==arguments[9]&&arguments[9],C=o.mcusPerLine,x=o.progressive,O=r,T=0,E=0;function readBit(){if(E>0){E--;return T>>E&1}if(255===(T=t[r++])){var c=t[r++];if(c){if(220===c&&S){r+=2;var g=(0,l.readUint16)(t,r);r+=2;if(g>0&&g!==o.scanLines)throw new h("Found DNL marker (0xFFDC) while parsing scan data",g)}else if(217===c){if(S){var y=j*(8===o.precision?8:0);if(y>0&&Math.round(o.scanLines/y)>=10)throw new h("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",y)}throw new d("Found EOI marker (0xFFD9) while parsing scan data")}throw new u("unexpected marker ".concat((T<<8|c).toString(16)))}}E=7;return T>>>7}function decodeHuffman(t){for(var r=t;;){switch(_typeof(r=r[readBit()])){case"number":return r;case"object":continue}throw new u("invalid huffman sequence")}}function receive(t){for(var r=0;t>0;){r=r<<1|readBit();t--}return r}function receiveAndExtend(t){if(1===t)return 1===readBit()?1:-1;var r=receive(t);return r>=1<<t-1?r:r+(-1<<t)+1}function decodeBaseline(t,r){var o=decodeHuffman(t.huffmanTableDC),c=0===o?0:receiveAndExtend(o);t.blockData[r]=t.pred+=c;for(var l=1;l<64;){var u=decodeHuffman(t.huffmanTableAC),h=15&u,d=u>>4;if(0!==h){var y=g[l+=d];t.blockData[r+y]=receiveAndExtend(h);l++}else{if(d<15)break;l+=16}}}function decodeDCFirst(t,r){var o=decodeHuffman(t.huffmanTableDC),c=0===o?0:receiveAndExtend(o)<<k;t.blockData[r]=t.pred+=c}function decodeDCSuccessive(t,r){t.blockData[r]|=readBit()<<k}var M=0;function decodeACFirst(t,r){if(M>0)M--;else for(var o=v,c=w;o<=c;){var l=decodeHuffman(t.huffmanTableAC),u=15&l,h=l>>4;if(0!==u){var d=g[o+=h];t.blockData[r+d]=receiveAndExtend(u)*(1<<k);o++}else{if(h<15){M=receive(h)+(1<<h)-1;break}o+=16}}}var R,L=0;function decodeACSuccessive(t,r){for(var o,c,l=v,h=w,d=0;l<=h;){var y=r+g[l],m=t.blockData[y]<0?-1:1;switch(L){case 0:d=(c=decodeHuffman(t.huffmanTableAC))>>4;if(0===(o=15&c))if(d<15){M=receive(d)+(1<<d);L=4}else{d=16;L=1}else{if(1!==o)throw new u("invalid ACn encoding");R=receiveAndExtend(o);L=d?2:3}continue;case 1:case 2:t.blockData[y]?t.blockData[y]+=m*(readBit()<<k):0===--d&&(L=2===L?3:0);break;case 3:if(t.blockData[y])t.blockData[y]+=m*(readBit()<<k);else{t.blockData[y]=R<<k;L=0}break;case 4:t.blockData[y]&&(t.blockData[y]+=m*(readBit()<<k))}l++}4===L&&0===--M&&(L=0)}var j=0;function decodeMcu(t,r,o,c,l){var u=o%C;j=(o/C|0)*t.v+c;var h=u*t.h+l;r(t,getBlockBufferOffset(t,j,h))}function decodeBlock(t,r,o){j=o/t.blocksPerLine|0;var c=o%t.blocksPerLine;r(t,getBlockBufferOffset(t,j,c))}var D,N,U,H,G,$,X=y.length;$=x?0===v?0===_?decodeDCFirst:decodeDCSuccessive:0===_?decodeACFirst:decodeACSuccessive:decodeBaseline;var q,z,W,V,K=0;z=1===X?y[0].blocksPerLine*y[0].blocksPerColumn:C*o.mcusPerColumn;for(;K<=z;){var Y=m?Math.min(z-K,m):z;if(Y>0){for(N=0;N<X;N++)y[N].pred=0;M=0;if(1===X){D=y[0];for(G=0;G<Y;G++){decodeBlock(D,$,K);K++}}else for(G=0;G<Y;G++){for(N=0;N<X;N++){W=(D=y[N]).h;V=D.v;for(U=0;U<V;U++)for(H=0;H<W;H++)decodeMcu(D,$,K,U,H)}K++}}E=0;if(!(q=findNextFileMarker(t,r)))break;if(q.invalid){var J=Y>0?"unexpected":"excessive";(0,c.warn)("decodeScan - ".concat(J," MCU data, current marker is: ").concat(q.invalid));r=q.offset}if(!(q.marker>=65488&&q.marker<=65495))break;r+=2}return r-O}