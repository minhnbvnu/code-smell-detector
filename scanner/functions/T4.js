function T4(e,t,r,i){var a=Math.ceil(t.n.bitLength()/8),n=zt.util.createBuffer(e),s=n.getByte(),o=n.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var u=0;if(o===0){u=a-3-i;for(var l=0;l<u;++l)if(n.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(u=0;n.length()>1;){if(n.getByte()!==255){--n.read;break}++u}else if(o===2)for(u=0;n.length()>1;){if(n.getByte()===0){--n.read;break}++u}var p=n.getByte();if(p!==0||u!==a-3-n.length())throw new Error("Encryption block is invalid.");return n.getBytes()}