function Y4e(e,t){var r=!1,i;e.version.minor===ds.Versions.TLS_1_0.minor?i=t.cipherState.init?null:t.cipherState.iv:i=e.fragment.getBytes(16),t.cipherState.init=!0;var a=t.cipherState.cipher;a.start({iv:i}),a.update(e.fragment),r=a.finish(X4e);var n=t.macLength,s=zl.random.getBytesSync(n),o=a.output.length();o>=n?(e.fragment=a.output.getBytes(o-n),s=a.output.getBytes(n)):e.fragment=a.output.getBytes(),e.fragment=zl.util.createBuffer(e.fragment),e.length=e.fragment.length();var u=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),r=Q4e(t.macKey,s,u)&&r,r}