function My97DP(){$c=this;$dp.$w=window;$dt=this.date=new DPDate();this.QS=[];$d=document.createElement("div");$d.className="WdateDiv";$d.onmousedown=hideSel;$d.innerHTML="<div id=dpTitle><div style=\"float:left\" class=\"navImg NavImgll\"></div><div style=\"float:left\" class=\"navImg NavImgl\"></div><div style=\"float:left\"><div class=\"menuSel MMenu\" style=\"z-index:1\"></div><input class=yminput tabindex=1></div><div style=\"float:left\"><div class=\"menuSel YMenu\" style=\"z-index:1\"></div><input class=yminput tabindex=2></div><div style=\"float:right\" class=\"navImg NavImgrr\"></div><div style=\"float:right\" class=\"navImg NavImgr\"></div></div><div style=\"position:absolute;overflow:hidden\"></div><div></div><div id=dpTime><div class=\"menuSel hhMenu\" style=\"z-index:1\"></div><div class=\"menuSel mmMenu\" style=\"z-index:1\"></div><div class=\"menuSel ssMenu\" style=\"z-index:1\"></div><table cellspacing=0 cellpadding=0 border=0><tr><td rowspan=2><span id=dpTimeStr></span>&nbsp;<input class=tB maxlength=2 tabindex=3><input value=\":\" class=tm readonly><input class=tE maxlength=2 tabindex=4><input value=\":\" class=tm readonly><input class=tE maxlength=2 tabindex=5></td><td><button id=dpTimeUp></button></td></tr><tr><td><button id=dpTimeDown></button></td></tr></table></div><div id=dpQS></div><div id=dpControl><input class=dpButton id=dpClearInput type=button tabindex=6> <input class=dpButton id=dpTodayInput type=button tabindex=7> <input class=dpButton id=dpOkInput type=button tabindex=8></div>";attachTabEvent($d,function(){hideSel()});_();this.init();$();$d.MI.attachEvent("onkeydown",A);$d.yI.attachEvent("onkeydown",A);$d.MI.onfocus=function($){this.className="yminputfocus";this.value=attr(this,"realValue");this.select();$c._fM();showB($d.MD)};$d.MI.onblur=function(){var $;if($lastInput==this){$dt.M=pIntDef(this.value,$dt.M);$=true}c_M($dt.M,$);this.className="yminput";hide($d.MD)};$d.yI.onfocus=function(){this.className="yminputfocus";this.select();$c._fy();showB($d.yD)};$d.yI.onblur=function(){var $;if($lastInput==this){$dt.y=pIntDef(this.value,$dt.y);$=true}c_y($dt.y,$);this.className="yminput";hide($d.yD)};$d.HI.onfocus=function(){$c.currFocus=this;this.select();$c._fH();showB($d.HD)};$d.HI.onblur=function(){var $;if($lastInput==this){$dt.H=pIntDef(this.value,$dt.H);$=true}c_H($dt.H,$);hide($d.HD)};$d.mI.onfocus=function(){$c.currFocus=this;this.select();$c._fm();showB($d.mD)};$d.mI.onblur=function(){var $;if($lastInput==this){$dt.m=pIntDef(this.value,$dt.m);$=true}c_m($dt.m,$);hide($d.mD)};$d.sI.onfocus=function(){$c.currFocus=this;this.select();$c._fs();showB($d.sD)};$d.sI.onblur=function(){var $;if($lastInput==this){$dt.s=pIntDef(this.value,$dt.s);$=true}c_s($dt.s,$);hide($d.sD)};$d.HI.attachEvent("onkeydown",A);$d.mI.attachEvent("onkeydown",A);$d.sI.attachEvent("onkeydown",A);$d.upButton.onclick=function(){updownEvent(1)};$d.downButton.onmousedown=function(){updownEvent(-1)};$d.qsDiv.onclick=function(){if($d.qsDivSel.style.display!="block"){$c._fillQS();showB($d.qsDivSel)}else hide($d.qsDivSel)};attachTabEvent($d.okI,function(){if($dp.dd.style.display!="none")$d.MI.focus();event.returnValue=false});document.body.appendChild($d);function _(){var A=$d.getElementsByTagName("div"),$=$d.getElementsByTagName("input"),B=$d.getElementsByTagName("button"),_=$d.getElementsByTagName("span");$d.navLeftImg=A[1];$d.leftImg=A[2];$d.rightImg=A[8];$d.navRightImg=A[7];$d.MI=$[0];$d.yI=$[1];$d.titleDiv=A[0];$d.MD=A[4];$d.yD=A[6];$d.qsDivSel=A[9];$d.dDiv=A[10];$d.tDiv=A[11];$d.HD=A[12];$d.mD=A[13];$d.sD=A[14];$d.qsDiv=A[15];$d.bDiv=A[16];$d.HI=$[2];$d.mI=$[4];$d.sI=$[6];$d.clearI=$[7];$d.todayI=$[8];$d.okI=$[9];$d.upButton=B[0];$d.downButton=B[1];$d.timeSpan=_[0]}function $(){$d.navLeftImg.onclick=function(){$ny=$ny<=0?$ny-1:-1;if($ny%5==0)$d.yI.focus();c_y($dt.y-1)};$d.leftImg.onclick=function(){var $=$dt.M;if($>1)$-=1;else{$=12;$dt.y-=1}s_y($dt.y);c_M($)};$d.rightImg.onclick=function(){var $=$dt.M;if($<12)$+=1;else{$=1;$dt.y+=1}s_y($dt.y);c_M($)};$d.navRightImg.onclick=function(){$ny=$ny>=0?$ny+1:1;if($ny%5==0)$d.yI.focus();c_y($dt.y+1)}}function A(){var $=event,_=($.which==undefined)?$.keyCode:$.which;if(!$OPERA&&!((_>=48&&_<=57)||(_>=96&&_<=105)||_==8||_==46||_==37||_==39||_==9))$.returnValue=false;$lastInput=$.srcElement}}