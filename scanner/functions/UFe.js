function UFe(e,t,r){var i=new qFe,a="",n=r&&r.maxLength,s=!(r&&r.trailing===!1);typeof e=="function"&&(t=e,e=null),e||(e=/\r?\n/);function o(l,p){if(t){try{p=t(p)}catch(c){return l.emit("error",c)}typeof p!="undefined"&&l.queue(p)}else l.queue(p)}function u(l,p){var c=((a??"")+p).split(e);if(a=c.pop(),n&&a.length>n)return l.emit("error",new Error("maximum buffer reached"));for(var d=0;d<c.length;d++){var f=c[d];o(l,f)}}return RFe(function(l){u(this,i.write(l))},function(){i.end&&u(this,i.end()),s&&a!=null&&o(this,a),this.queue(null)})}