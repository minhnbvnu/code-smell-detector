function coe(e,t,r){if(e.readOnly)return!1;let n=[],i=[];for(let a of xb(e)){if(r?a.to==e.doc.length:a.from==0)continue;let l=e.doc.lineAt(r?a.to+1:a.from-1),s=l.length+1;if(r){n.push({from:a.to,to:l.to},{from:a.from,insert:l.text+e.lineBreak});for(let u of a.ranges)i.push(ve.range(Math.min(e.doc.length,u.anchor+s),Math.min(e.doc.length,u.head+s)))}else{n.push({from:l.from,to:a.from},{from:a.to,insert:e.lineBreak+l.text});for(let u of a.ranges)i.push(ve.range(u.anchor-s,u.head-s))}}return n.length?(t(e.update({changes:n,scrollIntoView:!0,selection:ve.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0):!1}