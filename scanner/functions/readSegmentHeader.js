function readSegmentHeader(t,r){var o={};o.number=(0,l.readUint32)(t,r);var c=t[r+4],u=63&c;if(!m[u])throw new d("invalid segment type: "+u);o.type=u;o.typeName=m[u];o.deferredNonRetain=!!(128&c);var h=!!(64&c),g=t[r+5],y=g>>5&7,v=[31&g],w=r+6;if(7===g){y=536870911&(0,l.readUint32)(t,w-1);w+=3;var _=y+7>>3;v[0]=t[w++];for(;--_>0;)v.push(t[w++])}else if(5===g||6===g)throw new d("invalid referred-to flags");o.retainBits=v;var k=4;o.number<=256?k=1:o.number<=65536&&(k=2);var C,x,O=[];for(C=0;C<y;C++){var T=void 0;T=1===k?t[w]:2===k?(0,l.readUint16)(t,w):(0,l.readUint32)(t,w);O.push(T);w+=k}o.referredTo=O;if(h){o.pageAssociation=(0,l.readUint32)(t,w);w+=4}else o.pageAssociation=t[w++];o.length=(0,l.readUint32)(t,w);w+=4;if(4294967295===o.length){if(38!==u)throw new d("invalid unknown segment length");var E=readRegionSegmentInformation(t,w),M=!!(1&t[w+S]),R=new Uint8Array(6);if(!M){R[0]=255;R[1]=172}R[2]=E.height>>>24&255;R[3]=E.height>>16&255;R[4]=E.height>>8&255;R[5]=255&E.height;for(C=w,x=t.length;C<x;C++){for(var L=0;L<6&&R[L]===t[C+L];)L++;if(6===L){o.length=C+6;break}}if(4294967295===o.length)throw new d("segment end was not found")}o.headerEnd=w;return o}