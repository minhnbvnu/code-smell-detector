function vTe(e,t,r){let n=Object.assign(r?Object.assign({},r):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const i={},a=[];let l=[],s=[];const u={consume:y,enter:$,exit:x,attempt:A(k),check:A(C),interrupt:A(C,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:p,sliceSerialize:h,now:m,defineSkip:g,write:f};let d=t.tokenize.call(c,u);return t.resolveAll&&a.push(t),c;function f(T){return l=ya(l,T),b(),l[l.length-1]!==null?[]:(E(t,0),c.events=tM(a,c.events,c),c.events)}function h(T,B){return yTe(p(T),B)}function p(T){return bTe(l,T)}function m(){const{line:T,column:B,offset:R,_index:_,_bufferIndex:V}=n;return{line:T,column:B,offset:R,_index:_,_bufferIndex:V}}function g(T){i[T.line]=T.column,D()}function b(){let T;for(;n._index<l.length;){const B=l[n._index];if(typeof B=="string")for(T=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===T&&n._bufferIndex<B.length;)v(B.charCodeAt(n._bufferIndex));else v(B)}}function v(T){d=d(T)}function y(T){ft(T)?(n.line++,n.column=1,n.offset+=T===-3?2:1,D()):T!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===l[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=T}function $(T,B){const R=B||{};return R.type=T,R.start=m(),c.events.push(["enter",R,c]),s.push(R),R}function x(T){const B=s.pop();return B.end=m(),c.events.push(["exit",B,c]),B}function k(T,B){E(T,B.from)}function C(T,B){B.restore()}function A(T,B){return R;function R(_,V,W){let Z,K,q,F;return Array.isArray(_)?Q(_):"tokenize"in _?Q([_]):j(_);function j(ue){return se;function se(Se){const nt=Se!==null&&ue[Se],ge=Se!==null&&ue.null,Te=[...Array.isArray(nt)?nt:nt?[nt]:[],...Array.isArray(ge)?ge:ge?[ge]:[]];return Q(Te)(Se)}}function Q(ue){return Z=ue,K=0,ue.length===0?W:I(ue[K])}function I(ue){return se;function se(Se){return F=M(),q=ue,ue.partial||(c.currentConstruct=ue),ue.name&&c.parser.constructs.disable.null.includes(ue.name)?ee():ue.tokenize.call(B?Object.assign(Object.create(c),B):c,u,U,ee)(Se)}}function U(ue){return T(q,F),V}function ee(ue){return F.restore(),++K<Z.length?I(Z[K]):W}}}function E(T,B){T.resolveAll&&!a.includes(T)&&a.push(T),T.resolve&&_l(c.events,B,c.events.length-B,T.resolve(c.events.slice(B),c)),T.resolveTo&&(c.events=T.resolveTo(c.events,c))}function M(){const T=m(),B=c.previous,R=c.currentConstruct,_=c.events.length,V=Array.from(s);return{restore:W,from:_};function W(){n=T,c.previous=B,c.currentConstruct=R,c.events.length=_,s=V,D()}}function D(){n.line in i&&n.column<2&&(n.column=i[n.line],n.offset+=i[n.line]-1)}}