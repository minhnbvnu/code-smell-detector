function Lee(e,t,r){let{node:n,isVirtualized:i,focusMode:a="child",shouldSelectOnPressUp:l,onAction:s}=e,{direction:u}=pr(),{keyboardDelegate:c,actions:{onCellAction:d}}=eI.get(t),f=O.useRef(null),h=()=>{let $=ta(r.current);if(a==="child"){if(r.current.contains(document.activeElement)&&r.current!==document.activeElement)return;let x=t.selectionManager.childFocusStrategy==="last"?Zy($):$.firstChild();if(x){Tn(x);return}}(f.current!=null&&n.key!==f.current||!r.current.contains(document.activeElement))&&Tn(r.current)},{itemProps:p,isPressed:m}=z1({selectionManager:t.selectionManager,key:n.key,ref:r,isVirtualized:i,focus:h,shouldSelectOnPressUp:l,onAction:d?()=>d(n.key):s,isDisabled:t.collection.size===0}),v=$e(p,{role:"gridcell",onKeyDownCapture:$=>{if(!$.currentTarget.contains($.target)||t.isKeyboardNavigationDisabled)return;let x=ta(r.current);switch(x.currentNode=document.activeElement,$.key){case"ArrowLeft":{let k=u==="rtl"?x.nextNode():x.previousNode();if(a==="child"&&k===r.current&&(k=null),k)$.preventDefault(),$.stopPropagation(),Tn(k),ro(k,{containingElement:vl(r.current)});else{if(c.getKeyLeftOf(n.key)!==n.key)break;$.preventDefault(),$.stopPropagation(),a==="cell"&&u==="rtl"?(Tn(r.current),ro(r.current,{containingElement:vl(r.current)})):(x.currentNode=r.current,k=u==="rtl"?x.firstChild():Zy(x),k&&(Tn(k),ro(k,{containingElement:vl(r.current)})))}break}case"ArrowRight":{let k=u==="rtl"?x.previousNode():x.nextNode();if(a==="child"&&k===r.current&&(k=null),k)$.preventDefault(),$.stopPropagation(),Tn(k),ro(k,{containingElement:vl(r.current)});else{if(c.getKeyRightOf(n.key)!==n.key)break;$.preventDefault(),$.stopPropagation(),a==="cell"&&u==="ltr"?(Tn(r.current),ro(r.current,{containingElement:vl(r.current)})):(x.currentNode=r.current,k=u==="rtl"?Zy(x):x.firstChild(),k&&(Tn(k),ro(k,{containingElement:vl(r.current)})))}break}case"ArrowUp":case"ArrowDown":!$.altKey&&r.current.contains($.target)&&($.stopPropagation(),$.preventDefault(),r.current.parentElement.dispatchEvent(new KeyboardEvent($.nativeEvent.type,$.nativeEvent)));break}},onFocus:$=>{if(f.current=n.key,$.target!==r.current){yo()||t.selectionManager.setFocusedKey(n.key);return}requestAnimationFrame(()=>{a==="child"&&document.activeElement===r.current&&h()})}});var y;return i&&(v["aria-colindex"]=((y=n.colIndex)!==null&&y!==void 0?y:n.index)+1),l&&v.tabIndex!=null&&v.onPointerDown==null&&(v.onPointerDown=$=>{let x=$.currentTarget,k=x.getAttribute("tabindex");x.removeAttribute("tabindex"),requestAnimationFrame(()=>{x.setAttribute("tabindex",k)})}),{gridCellProps:v,isPressed:m}}