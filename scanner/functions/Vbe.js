function Vbe(e,t){let{expandedKeys:r=new Set}=t,n,i=[],a=0,l=0,s=[],u=new Map;t!=null&&t.showSelectionCheckboxes&&a++,t!=null&&t.showDragButtons&&a++;let c=[],d=m=>{switch(m.type){case"body":n=m,u.set(n.key,n);break;case"column":m.hasChildNodes||l++;break;case"item":c.push(m);return}for(let g of m.childNodes)d(g)};for(let m of e)m.type==="column"&&s.push(m),d(m);a+=l;let f=0,h=(m,g)=>{if(m.type==="item"){let $=[];for(let k of m.childNodes)if(k.type==="cell"){let C={...k};C.index+1===a&&(C.nextKey=null),$.push({...C})}let x={...m,childNodes:$,parentKey:n.key,level:1,index:f++};i.push(x)}let b={};m.type!=="placeholder"&&m.type!=="column"&&(b.indexOfType=g),Object.assign(m,b),u.set(m.key,m);let v,y=0;for(let $ of m.childNodes)$.type==="item"&&r!=="all"&&!r.has(m.key)||($.parentKey==null&&($.parentKey=m.key),v?(v.nextKey=$.key,$.prevKey=v.key):$.prevKey=null,$.type==="item"?h($,y++):h($,$.index),v=$);v&&(v.nextKey=null)},p;return c.forEach((m,g)=>{h(m,g),p?(p.nextKey=m.key,m.prevKey=p.key):m.prevKey=null,p=m}),p&&(p.nextKey=null),{keyMap:u,userColumnCount:l,flattenedRows:i,tableNodes:[...s,{...n,childNodes:i}]}}