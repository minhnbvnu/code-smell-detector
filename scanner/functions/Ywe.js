function Ywe(e,t){typeof e=="string"&&(e=aS.from(e,"binary")),Vo.buffer(e,"buf");var r=new fr.BerReader(e);if(r.readSequence(),Math.abs(r.length-r.remain)>1)throw new Error("DER sequence does not contain whole byte stream");var i=r.offset;r.readSequence();var a=r.offset+r.length,n=a;if(r.peek()===rn(0)){r.readSequence(rn(0));var s=r.readInt();Vo.ok(s<=3,"only x.509 versions up to v3 supported")}var o={};o.signatures={};var u=o.signatures.x509={};u.extras={},o.serial=Gwe(r,"serial"),r.readSequence();var l=r.offset+r.length,p=r.readOID(),c=to[p];if(c===void 0)throw new Error("unknown signature algorithm "+p);if(r._offset=l,o.issuer=bh.parseAsn1(r),r.readSequence(),o.validFrom=kK(r),o.validUntil=kK(r),o.subjects=[bh.parseAsn1(r)],r.readSequence(),l=r.offset+r.length,o.subjectKey=DK.readPkcs8(void 0,"public",r),r._offset=l,r.peek()===rn(1)&&(r.readSequence(rn(1)),u.extras.issuerUniqueID=e.slice(r.offset,r.offset+r.length),r._offset+=r.length),r.peek()===rn(2)&&(r.readSequence(rn(2)),u.extras.subjectUniqueID=e.slice(r.offset,r.offset+r.length),r._offset+=r.length),r.peek()===rn(3)){r.readSequence(rn(3));var f=r.offset+r.length;for(r.readSequence();r.offset<f;)Qwe(o,e,r);Vo.strictEqual(r.offset,f)}Vo.strictEqual(r.offset,a),r.readSequence(),l=r.offset+r.length;var d=r.readOID(),m=to[d];if(m===void 0)throw new Error("unknown signature algorithm "+d);r._offset=l;var h=r.readString(fr.Ber.BitString,!0);h[0]===0&&(h=h.slice(1));var g=m.split("-");return u.signature=Kwe.parse(h,g[0],"asn1"),u.signature.hashAlgorithm=g[1],u.algo=m,u.cache=e.slice(i,n),new Wwe(o)}