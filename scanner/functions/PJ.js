function PJ(t,e,n){let i,r,a,o,s;if(!t){o=qX(n.add(xH(null,[{}])))}else if(i=t.facet){if(!e)(0,g.vU)("Only group marks can be faceted.");if(i.field!=null){o=s=LJ(i,n)}else{if(!t.data){a=CJ((0,g.l7)({type:"aggregate",groupby:(0,g.IX)(i.groupby)},i.aggregate),n);a.params.key=n.keyRef(i.groupby);a.params.pulse=LJ(i,n);o=s=qX(n.add(a))}else{s=qX(n.getData(t.data).aggregate)}r=n.keyRef(i.groupby,true)}}if(!o){o=LJ(t,n)}return{key:r,pulse:o,parent:s}}