function Q6e(e,t,r=1){let n=e.charCategorizer(t),i=e.doc.lineAt(t),a=t-i.from;if(i.length==0)return ve.cursor(t);a==0?r=1:a==i.length&&(r=-1);let l=a,s=a;r<0?l=bi(i.text,a,!1):s=bi(i.text,a);let u=n(i.text.slice(l,s));for(;l>0;){let c=bi(i.text,l,!1);if(n(i.text.slice(c,l))!=u)break;l=c}for(;s<i.length;){let c=bi(i.text,s);if(n(i.text.slice(s,c))!=u)break;s=c}return ve.range(l+i.from,s+i.from)}