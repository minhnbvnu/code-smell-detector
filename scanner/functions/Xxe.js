function Xxe(e){let t=e.startState,r=!0;for(let i of t.facet(dae)){let a=i(e);if(a===!1){r=!1;break}Array.isArray(a)&&(r=r===!0?a:Gxe(r,a))}if(r!==!0){let i,a;if(r===!1)a=e.changes.invertedDesc,i=yn.empty(t.doc.length);else{let l=e.changes.filter(r);i=l.changes,a=l.filtered.mapDesc(l.changes).invertedDesc}e=hn.create(t,i,e.selection&&e.selection.map(a),Ar.mapEffects(e.effects,a),e.annotations,e.scrollIntoView)}let n=t.facet(fae);for(let i=n.length-1;i>=0;i--){let a=n[i](e);a instanceof hn?e=a:Array.isArray(a)&&a.length==1&&a[0]instanceof hn?e=a[0]:e=gae(t,Dc(a),!1)}return e}