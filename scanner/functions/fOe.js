function fOe(e){return new Promise(t=>{process.nextTick(()=>{let r=[];if(tl||Ap||Ip||Pp){let i='export LC_ALL=C; netstat -tunap | grep "ESTABLISHED\\|SYN_SENT\\|SYN_RECV\\|FIN_WAIT1\\|FIN_WAIT2\\|TIME_WAIT\\|CLOSE\\|CLOSE_WAIT\\|LAST_ACK\\|LISTEN\\|CLOSING\\|UNKNOWN"; unset LC_ALL';(Ap||Ip||Pp)&&(i='export LC_ALL=C; netstat -na | grep "ESTABLISHED\\|SYN_SENT\\|SYN_RECV\\|FIN_WAIT1\\|FIN_WAIT2\\|TIME_WAIT\\|CLOSE\\|CLOSE_WAIT\\|LAST_ACK\\|LISTEN\\|CLOSING\\|UNKNOWN"; unset LC_ALL'),po(i,{maxBuffer:1024*2e4},function(a,n){let s=n.toString().split(`
`);!a&&(s.length>1||s[0]!="")?(s.forEach(function(o){if(o=o.replace(/ +/g," ").split(" "),o.length>=7){let u=o[3],l="",p=o[3].split(":");p.length>1&&(l=p[p.length-1],p.pop(),u=p.join(":"));let c=o[4],d="",f=o[4].split(":");f.length>1&&(d=f[f.length-1],f.pop(),c=f.join(":"));let m=o[5],h=o[6].split("/");m&&r.push({protocol:o[0],localaddress:u,localport:l,peeraddress:c,peerport:d,state:m,pid:h[0]&&h[0]!=="-"?parseInt(h[0],10):-1,process:h[1]?h[1].split(" ")[0]:""})}}),e&&e(r),t(r)):(i='ss -tunap | grep "ESTAB\\|SYN-SENT\\|SYN-RECV\\|FIN-WAIT1\\|FIN-WAIT2\\|TIME-WAIT\\|CLOSE\\|CLOSE-WAIT\\|LAST-ACK\\|LISTEN\\|CLOSING"',po(i,{maxBuffer:1024*2e4},function(o,u){o||u.toString().split(`
`).forEach(function(p){if(p=p.replace(/ +/g," ").split(" "),p.length>=6){let c=p[4],d="",f=p[4].split(":");f.length>1&&(d=f[f.length-1],f.pop(),c=f.join(":"));let m=p[5],h="",g=p[5].split(":");g.length>1&&(h=g[g.length-1],g.pop(),m=g.join(":"));let y=p[1];y==="ESTAB"&&(y="ESTABLISHED"),y==="TIME-WAIT"&&(y="TIME_WAIT");let S=-1,x="";if(p.length>=7&&p[6].indexOf("users:")>-1){let w=p[6].replace('users:(("',"").replace(/"/g,"").split(",");w.length>2&&(x=w[0].split(" ")[0],S=parseInt(w[1],10))}y&&r.push({protocol:p[0],localaddress:c,localport:d,peeraddress:m,peerport:h,state:y,pid:S,process:x})}}),e&&e(r),t(r)}))})}if(Tp&&po('netstat -natv | grep "ESTABLISHED\\|SYN_SENT\\|SYN_RECV\\|FIN_WAIT1\\|FIN_WAIT2\\|TIME_WAIT\\|CLOSE\\|CLOSE_WAIT\\|LAST_ACK\\|LISTEN\\|CLOSING\\|UNKNOWN"',{maxBuffer:1024*2e4},function(a,n){a||(n.toString().split(`
`).forEach(function(o){if(o=o.replace(/ +/g," ").split(" "),o.length>=8){let u=o[3],l="",p=o[3].split(".");p.length>1&&(l=p[p.length-1],p.pop(),u=p.join("."));let c=o[4],d="",f=o[4].split(".");f.length>1&&(d=f[f.length-1],f.pop(),c=f.join("."));let m=o[5],h=parseInt(o[8],10);m&&r.push({protocol:o[0],localaddress:u,localport:l,peeraddress:c,peerport:d,state:m,pid:h,process:""})}}),e&&e(r),t(r))}),kf){let i="netstat -nao";try{po(i,Rt.execOptsWin,function(a,n){a||(n.toString().split(`\r
`).forEach(function(o){if(o=o.trim().replace(/ +/g," ").split(" "),o.length>=4){let u=o[1],l="",p=o[1].split(":");p.length>1&&(l=p[p.length-1],p.pop(),u=p.join(":"));let c=o[2],d="",f=o[2].split(":");f.length>1&&(d=f[f.length-1],f.pop(),c=f.join(":"));let m=o[4],h=o[3];h==="HERGESTELLT"&&(h="ESTABLISHED"),h.startsWith("ABH")&&(h="LISTEN"),h==="SCHLIESSEN_WARTEN"&&(h="CLOSE_WAIT"),h==="WARTEND"&&(h="TIME_WAIT"),h==="SYN_GESENDET"&&(h="SYN_SENT"),h==="LISTENING"&&(h="LISTEN"),h==="SYN_RECEIVED"&&(h="SYN_RECV"),h==="FIN_WAIT_1"&&(h="FIN_WAIT1"),h==="FIN_WAIT_2"&&(h="FIN_WAIT2"),h&&r.push({protocol:o[0].toLowerCase(),localaddress:u,localport:l,peeraddress:c,peerport:d,state:h,pid:m,process:""})}}),e&&e(r),t(r))})}catch{e&&e(r),t(r)}}})})}