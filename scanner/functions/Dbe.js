function Dbe(e){let{collection:t,focusMode:r}=e,n=VR(e),i=O.useMemo(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),a=n.setFocusedKey;n.setFocusedKey=(u,c)=>{if(r==="cell"&&u!=null){let h=t.getItem(u);if((h==null?void 0:h.type)==="item"){var d,f;let p=cr(h,t);c==="last"?u=(d=Yo(p))===null||d===void 0?void 0:d.key:u=(f=io(p))===null||f===void 0?void 0:f.key}}a(u,c)};let l=O.useMemo(()=>new zR(t,n),[t,n]);const s=O.useRef(null);return O.useEffect(()=>{if(n.focusedKey!=null&&!t.getItem(n.focusedKey)){const u=s.current.getItem(n.focusedKey),c=u.parentKey!=null&&(u.type==="cell"||u.type==="rowheader"||u.type==="column")?s.current.getItem(u.parentKey):u,d=s.current.rows,f=t.rows,h=d.length-f.length;let p=Math.min(h>1?Math.max(c.index-h+1,0):c.index,f.length-1),m;for(;p>=0;){if(!l.isDisabled(f[p].key)&&f[p].type!=="headerrow"){m=f[p];break}p<f.length-1?p++:(p>c.index&&(p=c.index),p--)}if(m){const g=m.hasChildNodes?[...cr(m,t)]:[],b=m.hasChildNodes&&c!==u&&u.index<g.length?g[u.index].key:m.key;n.setFocusedKey(b)}else n.setFocusedKey(null)}s.current=t},[t,l,n,n.focusedKey]),{collection:t,disabledKeys:i,isKeyboardNavigationDisabled:!1,selectionManager:l}}