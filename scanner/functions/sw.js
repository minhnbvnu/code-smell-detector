function sw(e,r){var t,a,n,i,s,f,l,o;var c={},u=[];e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")});e.FileIndex.forEach(function(e){if(!e.name.match(/\.iwa$/))return;if(e.content[0]==98)return;var r;try{r=zg(e.content)}catch(t){return console.log("?? "+e.content.length+" "+(t.message||t))}var a;try{a=Bg(r)}catch(t){return console.log("## "+(t.message||t))}a.forEach(function(e){c[e.id]=e.messages;u.push(e.id)})});if(!u.length)throw new Error("File has no messages");if(((i=(n=(a=(t=c==null?void 0:c[1])==null?void 0:t[0])==null?void 0:a.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Pg(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((o=(l=(f=(s=c==null?void 0:c[1])==null?void 0:s[0])==null?void 0:f.meta)==null?void 0:l[1])==null?void 0:o[0].data)&&Pg(c[1][0].meta[1][0].data)==1&&c[1][0];if(!h)u.forEach(function(e){c[e].forEach(function(e){var r=Pg(e.meta[1][0].data)>>>0;if(r==1){if(!h)h=e;else throw new Error("Document has multiple roots")}})});if(!h)throw new Error("Cannot find Document root");return iw(c,h,r)}