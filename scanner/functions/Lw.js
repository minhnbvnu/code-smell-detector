function Lw(e,r){o();var t=r||{};if(t.codepage&&typeof a==="undefined")console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results");if(typeof ArrayBuffer!=="undefined"&&e instanceof ArrayBuffer)return Lw(new Uint8Array(e),(t=yr(t),t.type="array",t));if(typeof Uint8Array!=="undefined"&&e instanceof Uint8Array&&!t.type)t.type=typeof Deno!=="undefined"?"buffer":"array";var n=e,i=[0,0,0,0],s=false;if(t.cellStyles){t.cellNF=true;t.sheetStubs=true}Jd={};if(t.dateNF)Jd.dateNF=t.dateNF;if(!t.type)t.type=y&&Buffer.isBuffer(e)?"buffer":"base64";if(t.type=="file"){t.type=y?"buffer":"binary";n=ir(e);if(typeof Uint8Array!=="undefined"&&!y)t.type="array"}if(t.type=="string"){s=true;t.type="binary";t.codepage=65001;n=Dw(e)}if(t.type=="array"&&typeof Uint8Array!=="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!=="undefined"){var f=new ArrayBuffer(3),l=new Uint8Array(f);l.foo="bar";if(!l.foo){t=yr(t);t.type="array";return Lw(I(n),t)}}switch((i=Cw(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Ow(er.read(n,t),t);break;case 9:if(i[1]<=8)return Nb(n,t);break;case 60:return lb(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Fl(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Rl.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?Rw(n,t):Pw(e,n,t,s);case 239:return i[3]===60?lb(n,t):Pw(e,n,t,s);case 255:if(i[1]===254){return Fw(n,t)}else if(i[1]===0&&i[2]===2&&i[3]===0)return Dl.to_workbook(n,t);break;case 0:if(i[1]===0){if(i[2]>=2&&i[3]===0)return Dl.to_workbook(n,t);if(i[2]===0&&(i[3]===8||i[3]===9))return Dl.to_workbook(n,t)}break;case 3:;case 131:;case 139:;case 140:return Cl.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return _o(n,t);break;case 10:;case 13:;case 32:return Iw(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(i[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(i[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(i[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break;}if(xl.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31)return Cl.to_workbook(n,t);return Pw(e,n,t,s)}