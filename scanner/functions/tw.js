function tw(e,r,t){var a,n,i,s,f,l;var o=Lg(r.data);var c={s:{r:0,c:0},e:{r:0,c:0}};c.e.r=(Pg(o[6][0].data)>>>0)-1;if(c.e.r<0)throw new Error("Invalid row varint ".concat(o[6][0].data));c.e.c=(Pg(o[7][0].data)>>>0)-1;if(c.e.c<0)throw new Error("Invalid col varint ".concat(o[7][0].data));t["!ref"]=Ba(c);var u=Array.isArray(t);var h=Lg(o[4][0].data);var d=Gg();if((a=h[4])==null?void 0:a[0])d.sst=Qg(e,e[Jg(h[4][0].data)][0]);if((n=h[11])==null?void 0:n[0])d.ofmt=Qg(e,e[Jg(h[11][0].data)][0]);if((i=h[17])==null?void 0:i[0])d.rsst=Qg(e,e[Jg(h[17][0].data)][0]);if((s=h[22])==null?void 0:s[0])d.nfmt=Qg(e,e[Jg(h[22][0].data)][0]);var v=Lg(h[3][0].data);var p=0;v[1].forEach(function(r){var a=Lg(r.data);var n=e[Jg(a[2][0].data)][0];var i=Pg(n.meta[1][0].data);if(i!=6002)throw new Error("6001 unexpected reference to ".concat(i));var s=rw(e,n);s.data.forEach(function(e,r){e.forEach(function(e,a){var n=Zg(e,d);if(n){if(u){if(!t[p+r])t[p+r]=[];t[p+r][a]=n}else{var i=Ma({r:p+r,c:a});t[i]=n}}})});p+=s.nrows});if((f=h[13])==null?void 0:f[0]){var m=e[Jg(h[13][0].data)][0];var b=Pg(m.meta[1][0].data);if(b!=6144)throw new Error("Expected merge type 6144, found ".concat(b));t["!merges"]=(l=Lg(m.data))==null?void 0:l[1].map(function(e){var r=Lg(e.data);var t=yg(Lg(r[1][0].data)[1][0].data),a=yg(Lg(r[2][0].data)[1][0].data);return{s:{r:t.getUint16(0,true),c:t.getUint16(2,true)},e:{r:t.getUint16(0,true)+a.getUint16(0,true)-1,c:t.getUint16(2,true)+a.getUint16(2,true)-1}}})}}