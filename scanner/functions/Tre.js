function Tre(e,t){let r=[],i=[],a={},n=!0,s=[],o=[],u={},l=!0;return e.forEach(function(p){if(p==="---")l=!1;else{let c=p.replace(/ +/g," ").split(" ");l?i.push({user:c[0],tty:c[1],date:c[2],time:c[3],ip:c&&c.length>4?c[4].replace(/\(/g,"").replace(/\)/g,""):""}):n?(s=c,s.forEach(function(d){o.push(p.indexOf(d))}),n=!1):(a.user=p.substring(o[0],o[1]-1).trim(),a.tty=p.substring(o[1],o[2]-1).trim(),a.ip=p.substring(o[2],o[3]-1).replace(/\(/g,"").replace(/\)/g,"").trim(),a.command=p.substring(o[7],1e3).trim(),u=i.filter(function(d){return d.user.substring(0,8).trim()===a.user&&d.tty===a.tty}),u.length===1&&r.push({user:u[0].user,tty:u[0].tty,date:u[0].date,time:u[0].time,ip:u[0].ip,command:a.command}))}}),r.length===0&&t===2?i:r}