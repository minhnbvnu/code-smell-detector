function U6e(e,t,r,n){let i=Z6e(e,t.head),a=!n||i.type!=Ha.Text||!(e.lineWrapping||i.widgetLineBreaks)?null:e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head);if(a){let l=e.dom.getBoundingClientRect(),s=e.textDirectionAt(i.from),u=e.posAtCoords({x:r==(s==wn.LTR)?l.right-1:l.left+1,y:(a.top+a.bottom)/2});if(u!=null)return ve.cursor(u,r?-1:1)}return ve.cursor(r?i.to:i.from,r?-1:1)}