function r_e(e,t,r,n){if(typeof e!="object"&&typeof e!="boolean")throw new Error("schema should be object or boolean");var i=this._opts.serialize,a=i?i(e):e,l=this._cache.get(a);if(l)return l;n=n||this._opts.addUsedSchema!==!1;var s=cu.normalizeId(this._getId(e));s&&n&&Aue(this,s);var u=this._opts.validateSchema!==!1&&!t,c;u&&!(c=s&&s==cu.normalizeId(e.$schema))&&this.validateSchema(e,!0);var d=cu.ids.call(this,e),f=new wue({id:s,schema:e,localRefs:d,cacheKey:a,meta:r});return s[0]!="#"&&n&&(this._refs[s]=f),this._cache.put(a,f),u&&c&&this.validateSchema(e,!0),f}