function yke(e,t,r){if(!t&&e.length===0)return[];if(e=ie.fromDer(e,t),e.tagClass!==ie.Class.UNIVERSAL||e.type!==ie.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var i=[],a=0;a<e.value.length;a++){var n=e.value[a],s={},o=[];if(!ie.validate(n,dke,s,o)){var u=new Error("Cannot read SafeBag.");throw u.errors=o,u}var l={type:ie.derToOid(s.bagId),attributes:xke(s.bagAttributes)};i.push(l);var p,c,d=s.bagValue.value[0];switch(l.type){case sr.oids.pkcs8ShroudedKeyBag:if(d=sr.decryptPrivateKeyInfo(d,r),d===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case sr.oids.keyBag:try{l.key=sr.privateKeyFromAsn1(d)}catch{l.key=null,l.asn1=d}continue;case sr.oids.certBag:p=hke,c=function(){if(ie.derToOid(s.certId)!==sr.oids.x509Certificate){var m=new Error("Unsupported certificate type, only X.509 supported.");throw m.oid=ie.derToOid(s.certId),m}var h=ie.fromDer(s.cert,t);try{l.cert=sr.certificateFromAsn1(h,!0)}catch{l.cert=null,l.asn1=h}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=l.type,u}if(p!==void 0&&!ie.validate(d,p,s,o)){var u=new Error("Cannot read PKCS#12 "+p.name);throw u.errors=o,u}c()}return i}