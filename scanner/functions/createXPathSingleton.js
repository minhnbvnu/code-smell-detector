function createXPathSingleton(){function g(b,a,c){return-1!==b&&(b<a||-1===a)&&(b<c||-1===c)}function k(b){for(var a=[],c=0,d=b.length,h;c<d;){var f=b,n=d,k=a,r="",p=[],q=f.indexOf("[",c),t=f.indexOf("/",c),A=f.indexOf("=",c);g(t,q,A)?(r=f.substring(c,t),c=t+1):g(q,t,A)?(r=f.substring(c,q),c=e(f,q,p)):g(A,t,q)?(r=f.substring(c,A),c=A):(r=f.substring(c,n),c=n);k.push({location:r,predicates:p});if(c<d&&"="===b[c]){h=b.substring(c+1,d);if(2<h.length&&("'"===h[0]||'"'===h[0]))h=h.slice(1,h.length-1);
else try{h=parseInt(h,10)}catch(I){}c=d}}return{steps:a,value:h}}function d(){var b=null,a=!1;this.setNode=function(a){b=a};this.reset=function(){a=!1};this.next=function(){var c=a?null:b;a=!0;return c}}function b(b,a,c){this.reset=function(){b.reset()};this.next=function(){for(var d=b.next();d;){d.nodeType===Node.ELEMENT_NODE&&(d=d.getAttributeNodeNS(a,c));if(d)break;d=b.next()}return d}}function f(b,a){var c=b.next(),d=null;this.reset=function(){b.reset();c=b.next();d=null};this.next=function(){for(;c;){if(d)if(a&&
d.firstChild)d=d.firstChild;else{for(;!d.nextSibling&&d!==c;)d=d.parentNode;d===c?c=b.next():d=d.nextSibling}else{do(d=c.firstChild)||(c=b.next());while(c&&!d)}if(d&&d.nodeType===Node.ELEMENT_NODE)return d}return null}}function n(b,a){this.reset=function(){b.reset()};this.next=function(){for(var c=b.next();c&&!a(c);)c=b.next();return c}}function p(b,a,c){a=a.split(":",2);var d=c(a[0]),h=a[1];return new n(b,function(a){return a.localName===h&&a.namespaceURI===d})}function r(b,a,c){var m=new d,h=q(m,
a,c),e=a.value;return void 0===e?new n(b,function(a){m.setNode(a);h.reset();return null!==h.next()}):new n(b,function(a){m.setNode(a);h.reset();return(a=h.next())?a.nodeValue===e:!1})}var q,e;e=function(b,a,c){for(var d=a,h=b.length,e=0;d<h;)"]"===b[d]?(--e,0>=e&&c.push(k(b.substring(a,d)))):"["===b[d]&&(0>=e&&(a=d+1),e+=1),d+=1;return d};q=function(d,a,c){var m,h,e,n;for(m=0;m<a.steps.length;m+=1){e=a.steps[m];h=e.location;if(""===h)d=new f(d,!1);else if("@"===h[0]){h=h.substr(1).split(":",2);n=
c(h[0]);if(!n)throw"No namespace associated with the prefix "+h[0];d=new b(d,n,h[1])}else"."!==h&&(d=new f(d,!1),-1!==h.indexOf(":")&&(d=p(d,h,c)));for(h=0;h<e.predicates.length;h+=1)n=e.predicates[h],d=r(d,n,c)}return d};return{getODFElementsWithXPath:function(b,a,c){var m=b.ownerDocument,h=[],e=null;if(m&&"function"===typeof m.evaluate)for(c=m.evaluate(a,b,c,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),e=c.iterateNext();null!==e;)e.nodeType===Node.ELEMENT_NODE&&h.push(e),e=c.iterateNext();else{h=
new d;h.setNode(b);b=k(a);h=q(h,b,c);b=[];for(c=h.next();c;)b.push(c),c=h.next();h=b}return h}}}