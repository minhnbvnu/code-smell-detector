function Hxe(e,t,r){let n=[[],[],[],[],[]],i=new Map;function a(l,s){let u=i.get(l);if(u!=null){if(u<=s)return;let c=n[u].indexOf(l);c>-1&&n[u].splice(c,1),l instanceof sD&&r.delete(l.compartment)}if(i.set(l,s),Array.isArray(l))for(let c of l)a(c,s);else if(l instanceof sD){if(r.has(l.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(l.compartment)||l.inner;r.set(l.compartment,c),a(c,s)}else if(l instanceof sae)a(l.inner,l.prec);else if(l instanceof rl)n[s].push(l),l.provides&&a(l.provides,s);else if(l instanceof Km)n[s].push(l),l.facet.extensions&&a(l.facet.extensions,Gs.default);else{let c=l.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${l}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(c,s)}}return a(e,Gs.default),n.reduce((l,s)=>l.concat(s))}