function mv(e,r,t,a,n,i,s){if(!e)return e;if(!a)a={"!id":{}};if(b!=null&&r.dense==null)r.dense=b;var f=r.dense?[]:{};var l={s:{r:2e6,c:2e6},e:{r:0,c:0}};var o="",c="";var u=e.match(fv);if(u){o=e.slice(0,u.index);c=e.slice(u.index+u[0].length)}else o=c=e;var h=o.match(dv);if(h)gv(h[0],f,n,t);else if(h=o.match(vv))wv(h[0],h[1]||"",f,n,t,s,i);var d=(o.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=o.slice(d,d+50).match(ov);if(v)iv(f,v[1])}var p=o.match(pv);if(p&&p[1])Iv(p[1],n);var m=[];if(r.cellStyles){var g=o.match(cv);if(g)xv(m,g)}if(u)Pv(u[1],f,r,l,i,s);var w=c.match(uv);if(w)f["!autofilter"]=Ov(w[0]);var k=[];var T=c.match(sv);if(T)for(d=0;d!=T.length;++d)k[d]=za(T[d].slice(T[d].indexOf('"')+1));var E=c.match(lv);if(E)Sv(f,E,a);var y=c.match(hv);if(y)f["!margins"]=_v(Jr(y[0]));if(!f["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r)f["!ref"]=Ba(l);if(r.sheetRows>0&&f["!ref"]){var S=za(f["!ref"]);if(r.sheetRows<=+S.e.r){S.e.r=r.sheetRows-1;if(S.e.r>l.e.r)S.e.r=l.e.r;if(S.e.r<S.s.r)S.s.r=S.e.r;if(S.e.c>l.e.c)S.e.c=l.e.c;if(S.e.c<S.s.c)S.s.c=S.e.c;f["!fullref"]=f["!ref"];f["!ref"]=Ba(S)}}if(m.length>0)f["!cols"]=m;if(k.length>0)f["!merges"]=k;return f}