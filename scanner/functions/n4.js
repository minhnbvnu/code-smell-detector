function n4(e,t){tf.object(e.signatures.openssh,"signature for openssh format");var r=e.signatures.openssh;r.nonce===void 0&&(r.nonce=jwe.randomBytes(16));var i=new cp({});i.writeString(SK(e.subjectKey)),i.writeBuffer(r.nonce);var a=e.subjectKey,n=rS.info[a.type];n.parts.forEach(function(p){i.writePart(a.part[p])}),i.writeInt64(e.serial);var s=e.subjects[0].type;tf.notStrictEqual(s,"unknown"),e.subjects.forEach(function(p){tf.strictEqual(p.type,s)}),s=rf[s],i.writeInt(s),r.keyId===void 0&&(r.keyId=e.subjects[0].type+"_"+(e.subjects[0].uid||e.subjects[0].hostname)),i.writeString(r.keyId);var o=new cp({});e.subjects.forEach(function(p){s===rf.host?o.writeString(p.hostname):s===rf.user&&o.writeString(p.uid)}),i.writeBuffer(o.toBuffer()),i.writeInt64(wK(e.validFrom)),i.writeInt64(wK(e.validUntil));var u=r.exts;u===void 0&&(u=[]);var l=new cp({});return u.forEach(function(p){p.critical===!0&&(l.writeString(p.name),l.writeBuffer(p.data))}),i.writeBuffer(l.toBuffer()),l=new cp({}),u.forEach(function(p){p.critical!==!0&&(l.writeString(p.name),l.writeBuffer(p.data))}),i.writeBuffer(l.toBuffer()),i.writeBuffer(a4.alloc(0)),o=vK.write(e.issuerKey),i.writeBuffer(o),t||i.writeBuffer(r.signature.toBuffer("ssh")),i.toBuffer()}