function k3(n,t,e,i){return Dr("Finding nearest neighbors...",()=>{let r=n.length,o=new Array(r),s=new Array(r);for(let a=0;a<r;a++)s[a]=new uc(t);for(let a=0;a<r;a++){let l=e(n[a]),c=s[a];for(let u=a+1;u<r;u++){let h=s[u],p=c.getSize()===t&&c.getLargestKey()||Number.MAX_VALUE,d=h.getSize()===t&&h.getLargestKey()||Number.MAX_VALUE,f=Math.max(p,d),m=i(l,e(n[u]),f);m>=0&&(c.add(m,{index:u,dist:m}),h.add(m,{index:a,dist:m}))}}for(let a=0;a<r;a++)o[a]=s[a].getMinKItems();return o})}