function Mv(e,r,t,a){var n=[Gr,xt("worksheet",null,{xmlns:Ft[0],"xmlns:r":It.r})];var i=t.SheetNames[e],s=0,f="";var l=t.Sheets[i];if(l==null)l={};var o=l["!ref"]||"A1";var c=za(o);if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+o+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383);c.e.r=Math.min(c.e.c,1048575);o=Ba(c)}if(!a)a={};l["!comments"]=[];var u=[];kv(l,t,e,r,n);n[n.length]=xt("dimension",null,{ref:o});n[n.length]=Fv(l,r,e,t);if(r.sheetFormat)n[n.length]=xt("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"});if(l["!cols"]!=null&&l["!cols"].length>0)n[n.length]=Cv(l,l["!cols"]);n[s=n.length]="<sheetData/>";l["!links"]=[];if(l["!ref"]!=null){f=Lv(l,r,e,t,a);if(f.length>0)n[n.length]=f}if(n.length>s+1){n[n.length]="</sheetData>";n[s]=n[s].replace("/>",">")}if(l["!protect"])n[n.length]=yv(l["!protect"]);if(l["!autofilter"]!=null)n[n.length]=Rv(l["!autofilter"],l,t,e);if(l["!merges"]!=null&&l["!merges"].length>0)n[n.length]=bv(l["!merges"]);var h=-1,d,v=-1;if(l["!links"].length>0){n[n.length]="<hyperlinks>";l["!links"].forEach(function(e){if(!e[1].Target)return;d={ref:e[0]};if(e[1].Target.charAt(0)!="#"){v=oi(a,-1,nt(e[1].Target).replace(/#.*$/,""),ii.HLINK);d["r:id"]="rId"+v}if((h=e[1].Target.indexOf("#"))>-1)d.location=nt(e[1].Target.slice(h+1));if(e[1].Tooltip)d.tooltip=nt(e[1].Tooltip);n[n.length]=xt("hyperlink",null,d)});n[n.length]="</hyperlinks>"}delete l["!links"];if(l["!margins"]!=null)n[n.length]=Av(l["!margins"]);if(!r||r.ignoreEC||r.ignoreEC==void 0)n[n.length]=_t("ignoredErrors",xt("ignoredError",null,{numberStoredAsText:1,sqref:o}));if(u.length>0){v=oi(a,-1,"../drawings/drawing"+(e+1)+".xml",ii.DRAW);n[n.length]=xt("drawing",null,{"r:id":"rId"+v});l["!drawing"]=u}if(l["!comments"].length>0){v=oi(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ii.VML);n[n.length]=xt("legacyDrawing",null,{"r:id":"rId"+v});l["!legacy"]=v}if(n.length>1){n[n.length]="</worksheet>";n[1]=n[1].replace("/>",">")}return n.join("")}