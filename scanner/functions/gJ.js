function gJ(e,t){t.classHierarchy.push("vtkShapeWidgetProp"),t.keysDown={};var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fJ(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fJ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);e.setDisplayCallback=function(e){return t.representations[0].setDisplayCallback(e)},e.setText=function(e){t.widgetState.getText().setText(e),t.interactor.render()},e.setResetAfterPointPlacement=t.factory.setResetAfterPointPlacement,e.getResetAfterPointPlacement=t.factory.getResetAfterPointPlacement,e.setModifierBehavior=t.factory.setModifierBehavior,e.getModifierBehavior=t.factory.getModifierBehavior,e.isBehaviorActive=function(n,r){return Object.keys(t.keysDown).some((function(i){return t.keysDown[i]&&e.getModifierBehavior()[i]&&e.getModifierBehavior()[i][n]===r}))},e.isOppositeBehaviorActive=function(t,n){return Object.values(ZZ[t]).some((function(r){return n!==r&&e.isBehaviorActive(t,r)}))},e.getActiveBehaviorFromCategory=function(t){return Object.values(ZZ[t]).find((function(n){return e.isBehaviorActive(t,n)||!e.isOppositeBehaviorActive(t,n)&&e.getModifierBehavior().None[t]===n}))},e.isRatioFixed=function(){return e.getActiveBehaviorFromCategory(YZ)===ZZ[YZ].FIXED},e.isDraggingEnabled=function(){var t=e.getActiveBehaviorFromCategory(qZ);return t===ZZ[qZ].DRAG||t===ZZ[qZ].CLICK_AND_DRAG},e.isDraggingForced=function(){return e.isBehaviorActive(qZ,ZZ[qZ].DRAG)||e.getModifierBehavior().None[qZ]===ZZ[qZ].DRAG},e.getPoint1=function(){return t.point1},e.getPoint2=function(){return t.point2},e.setPoints=function(n,r){t.point1=n,t.point2=r,t.point1Handle.setOrigin(t.point1),t.point2Handle.setOrigin(t.point2),e.updateShapeBounds()},e.placePoint1=function(n){t.hasFocus&&(e.setPoints(n,n),t.point1Handle.deactivate(),t.point2Handle.activate(),t.activeState=t.point2Handle,t.point2Handle.setVisible(!0),e.updateShapeBounds(),t.shapeHandle.setVisible(!0))},e.placePoint2=function(n){t.hasFocus&&(t.point2=n,t.point2Handle.setOrigin(t.point2),e.updateShapeBounds(),e.getResetAfterPointPlacement()?e.reset():e.loseFocus())},e.makeSquareFromPoints=function(e,n){var r=[0,0,0];Xi(r,n,e);var i=t.shapeHandle.getDirection(),o=t.shapeHandle.getRight(),a=t.shapeHandle.getUp(),s=uo(r,i),l=uo(r,o),u=uo(r,a),c=Math.abs(l),d=Math.abs(u);return c<mJ?l=u:d<mJ?u=l:c>d?u=u/d*c:l=l/c*d,[e[0]+l*o[0]+u*a[0]+s*i[0],e[1]+l*o[1]+u*a[1]+s*i[1],e[2]+l*o[2]+u*a[2]+s*i[2]]};var r=function(e,n){var r=ro(e,n),i=t.shapeHandle.getUp(),o=t.shapeHandle.getRight();return{point1:[e[0]+(i[0]-o[0])*r,e[1]+(i[1]-o[1])*r,e[2]+(i[2]-o[2])*r],point2:[e[0]+(o[0]-i[0])*r,e[1]+(o[1]-i[1])*r,e[2]+(o[2]-i[2])*r]}};e.getBounds=function(){return t.point1&&t.point2?Fn.computeBoundsFromPoints(t.point1,t.point2,[]):Fn.uninitializeBounds([])},e.setCorners=function(t,n){e.updateTextPosition(t,n)},e.updateShapeBounds=function(){if(t.point1&&t.point2){var n=y(t.point1),i=y(t.point2);switch(e.isRatioFixed()&&(i=e.makeSquareFromPoints(n,i)),e.getActiveBehaviorFromCategory(XZ)){case ZZ[XZ].CORNER_TO_CORNER:e.setCorners(n,i);break;case ZZ[XZ].CENTER_TO_CORNER:var o=[0,0,0];Xi(o,n,i),Ki(n,n,o),e.setCorners(n,i);break;case ZZ[XZ].RADIUS:var a=r(n,i);e.setCorners(a.point1,a.point2);break;case ZZ[XZ].DIAMETER:var s=function(e,t){var n=[.5*(e[0]+t[0]),.5*(e[1]+t[1]),.5*(e[2]+t[2])];return r(n,e)}(n,i);e.setCorners(s.point1,s.point2);break;default:hJ("vtk internal error")}}};var i=function(e,t,n){var r=[0,0,0];switch(e){case JZ:break;case $Z:Fn.subtract(n,t,r);break;default:Fn.subtract(n,t,r),Fn.multiplyScalar(r,.5)}return r};e.updateTextPosition=function(e,n){var r=function(e,n){var r,o,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=t.manipulator.getOrigin(),u=t.manipulator.getNormal(),c=t.renderer.getActiveCamera().getViewUp(),d=Array.isArray(s)?y(s):[s,s,l?s:0],p=(r=t.apiSpecificRenderWindow).worldToDisplay.apply(r,y(oi.getMinPoint(e)).concat([t.renderer])),f=(o=t.apiSpecificRenderWindow).worldToDisplay.apply(o,y(oi.getMaxPoint(e)).concat([t.renderer])),h=Fn.computeBoundsFromPoints(p,f,[]),m=[],g=[],v=[],b=[];if(l&&u&&c&&oi.intersectPlane(h,l,u)){var w,x,S=(w=t.apiSpecificRenderWindow).worldToDisplay.apply(w,y(l).concat([t.renderer])),C=Fn.add(l,u,[]),A=(x=t.apiSpecificRenderWindow).worldToDisplay.apply(x,y(C).concat([t.renderer])),P=Fn.subtract(A,S),_=10*oi.getDiagonalLength(h);Cr.projectPoint(oi.getCenter(h),S,P,m);var O=Fn.cross(c,P,[]);Fn.normalize(O),Fn.normalize(c),Fn.normalize(P),Fn.multiplyAccumulate(m,c,-_,m),Fn.multiplyAccumulate(m,O,-_,m),b=m,aP(h,m,g=Fn.multiplyAccumulate(m,O,2*_,[]),v=Fn.multiplyAccumulate(m,c,2*_,[]))}else m=[h[0],h[2],h[4]],g=[h[1],h[2],h[4]],v=[h[0],h[3],h[4]],b=[h[0],h[2],h[5]];var T=i(n[0],m,g),D=i(n[1],m,v),E=i(n[2],m,b),I=m;return Fn.add(I,T,I),Fn.add(I,D,I),Fn.add(I,E,I),Fn.add(I,d,I),(a=t.apiSpecificRenderWindow).displayToWorld.apply(a,I.concat([t.renderer]))}(Fn.computeBoundsFromPoints(e,n,[]),t.widgetState.getTextPosition(),t.widgetState.getTextWorldMargin());t.widgetState.getText().setOrigin(r)},e.reset=function(){t.hasFocus||t.point1Handle.setVisible(!1),t.shapeHandle.setVisible(!1),t.point1=null,t.point2=null,t.widgetState.getText().setVisible(!1),t.point1Handle.setOrigin(t.point2Handle.getOrigin()),t.point2Handle.setVisible(!1),t.point2Handle.deactivate(),t.hasFocus?(t.point1Handle.activate(),t.activeState=t.point1Handle):(t.point1Handle.deactivate(),t.activeState=null),e.updateShapeBounds()},e.handleMouseMove=function(n){if(!(t.activeState&&t.activeState.getActive()&&t.pickable&&t.dragable&&t.manipulator))return Se.VOID;if(!t.point2){var r=t.camera.getDirectionOfProjection(),i=t.camera.getViewUp(),o=[];co(o,i,r),t.shapeHandle.setUp(i),t.shapeHandle.setRight(o),t.shapeHandle.setDirection(r),t.manipulator.setNormal(r)}var a=t.manipulator.handleEvent(n,t.apiSpecificRenderWindow);return a.length?(t.hasFocus?t.point1?(t.point2Handle.setOrigin(a),t.point2=a,e.updateShapeBounds(),e.invokeInteractionEvent()):t.point1Handle.setOrigin(a):t.isDragging&&(t.activeState===t.point1Handle?(t.point1Handle.setOrigin(a),t.point1=a):(t.point2Handle.setOrigin(a),t.point2=a),e.updateShapeBounds(),e.invokeInteractionEvent()),t.hasFocus?Se.EVENT_ABORT:Se.VOID):Se.VOID},e.handleLeftButtonPress=function(n){return t.activeState&&t.activeState.getActive()&&t.pickable?t.hasFocus?(t.point1?(e.placePoint2(t.point2Handle.getOrigin()),e.invokeInteractionEvent(),e.invokeEndInteractionEvent()):(e.placePoint1(t.point1Handle.getOrigin()),e.invokeStartInteractionEvent()),Se.EVENT_ABORT):!t.point1||t.activeState!==t.point1Handle&&t.activeState!==t.point2Handle?Se.VOID:(t.isDragging=!0,t.apiSpecificRenderWindow.setCursor("grabbing"),t.interactor.requestAnimation(e),e.invokeStartInteractionEvent(),Se.EVENT_ABORT):Se.VOID},e.handleLeftButtonRelease=function(n){if(t.isDragging)return t.isDragging=!1,t.apiSpecificRenderWindow.setCursor("pointer"),t.widgetState.deactivate(),t.interactor.cancelAnimation(e),e.invokeEndInteractionEvent(),Se.EVENT_ABORT;if(!t.hasFocus||!t.pickable)return Se.VOID;var r=t.apiSpecificRenderWindow.getSize();if(n.position.x<0||n.position.x>r[0]-1||n.position.y<0||n.position.y>r[1]-1)return Se.VOID;if(t.point1&&(t.point2=t.point2Handle.getOrigin(),e.updateShapeBounds(),e.isDraggingEnabled())){(io(t.point1,t.point2)>100||e.isDraggingForced())&&(e.invokeInteractionEvent(),e.invokeEndInteractionEvent(),e.getResetAfterPointPlacement()?e.reset():e.loseFocus())}return Se.EVENT_ABORT},e.handleKeyDown=function(n){var r=n.key;"Escape"===r?t.hasFocus&&(e.invokeEndInteractionEvent(),e.reset(),e.loseFocus()):t.keysDown[r]=!0,t.hasFocus&&t.point1&&(t.point2=t.point2Handle.getOrigin(),e.updateShapeBounds())},e.handleKeyUp=function(n){var r=n.key;t.keysDown[r]=!1,t.hasFocus&&t.point1&&(t.point2=t.point2Handle.getOrigin(),e.updateShapeBounds())},e.grabFocus=function(){t.hasFocus||(e.reset(),t.point1Handle.activate(),t.activeState=t.point1Handle,t.point1Handle.setVisible(!0),t.shapeHandle.setVisible(!1),t.interactor.requestAnimation(e)),n.grabFocus()},e.loseFocus=function(){t.hasFocus&&t.interactor.cancelAnimation(e),t.point1||(t.point1Handle.setVisible(!1),t.point2Handle.setVisible(!1)),t.widgetState.deactivate(),t.point1Handle.deactivate(),t.point2Handle.deactivate(),t.activeState=null,t.interactor.render(),t.widgetManager.enablePicking(),n.loseFocus()}}