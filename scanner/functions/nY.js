function nY(t,e,n){const i=iY(t.sort,true);let r,a;const o=n.map((t=>{const n=e.getData(t.data);if(!n)GH(t.data);return n.countsRef(e,t.field,i)}));const s={groupby:LX,pulse:o};if(i){r=i.op||"count";a=i.field?JX(r,i.field):"count";s.ops=[XH[r]];s.fields=[e.fieldRef(a)];s.as=[a]}r=e.add(mH(s));const u=e.add(xH({pulse:qX(r)}));a=e.add(jH({field:LX,sort:e.sortRef(i),pulse:qX(u)}));return qX(a)}