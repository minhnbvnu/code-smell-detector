function SF(n,t){if(!n)return d=new Array(this.size()),c=-1,this.each(function(S){d[++c]=S}),d;var e=t?Dst:Lst,i=this._parents,r=this._groups;typeof n!="function"&&(n=_F(n));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=i[c],h=r[c],p=h.length,d=n.call(u,u&&u.__data__,c,i),f=d.length,m=a[c]=new Array(f),x=s[c]=new Array(f),g=l[c]=new Array(p);e(u,h,m,x,g,d,t);for(var v=0,b=0,y,_;v<f;++v)if(y=m[v]){for(v>=b&&(b=v+1);!(_=x[b])&&++b<f;);y._next=_||null}}return s=new wn(s,i),s._enter=a,s._exit=l,s}