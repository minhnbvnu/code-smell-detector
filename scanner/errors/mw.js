function mw(e,r,t,a,n,i){var s,f;var l=Ua(t["!ref"]);l.s.r=l.s.c=0;var o=false;if(l.e.c>999){o=true;l.e.c=999}if(l.e.r>999999){o=true;l.e.r=999999}if(o)console.error("Truncating to ".concat(Ba(l)));var c=ek(t,{range:l,header:1});var u=["~Sh33tJ5~"],h=new Set(u);c.forEach(function(e){return e.forEach(function(e){if(typeof e=="string"&&!h.has(e)){u.push(e);h.add(e)}})});var d=r[i].location;d=d.replace(/^Root Entry\//,"");d=d.replace(/^Index\//,"").replace(/\.iwa$/,"");var v=Lg(a.messages[0].data);{v[6][0].data=Ig(l.e.r+1);v[7][0].data=Ig(l.e.c+1);delete v[46];var p=Lg(v[4][0].data);{var m=Jg(Lg(p[1][0].data)[2][0].data);hw(e,r,m,function(e,r){var t;var a=Lg(e.messages[0].data);if((t=a==null?void 0:a[2])==null?void 0:t[0])for(var n=0;n<c.length;++n){var i=Lg(a[2][0].data);i[1][0].data=Ig(n);i[4][0].data=Ig(c[n].length);a[2][n]={type:a[2][0].type,data:Mg(i)}}e.messages[0].data=Mg(a)});var b=Jg(p[2][0].data);hw(e,r,b,function(e,r){var t=Lg(e.messages[0].data);for(var a=0;a<=l.e.c;++a){var n=Lg(t[2][0].data);n[1][0].data=Ig(a);n[4][0].data=Ig(l.e.r+1);t[2][a]={type:t[2][0].type,data:Mg(n)}}e.messages[0].data=Mg(t)});var g=Jg(p[4][0].data);hw(e,r,g,function(e){var r=Lg(e.messages[0].data);{r[3]=[];u.forEach(function(e,t){r[3].push({type:2,data:Mg([[],[{type:0,data:Ig(t)}],[{type:0,data:Ig(1)}],[{type:2,data:_g(e)}]])})})}e.messages[0].data=Mg(r)});var w=Lg(p[9][0].data);w[1]=[];var k=Lg(p[3][0].data);{var T=256;k[2]=[{type:0,data:Ig(T)}];var E=Jg(Lg(k[1][0].data)[2][0].data);var y=0;{er.utils.cfb_del(e,r[E].location);hw(e,r,2,function(e){var r=Lg(e.messages[0].data);var t=r[3].filter(function(e){return Ng(Lg(e.data)[1][0].data)==E});if(t&&t.length>0)y=Ng(Lg(t[0].data)[12][0].data);r[3]=r[3].filter(function(e){return Ng(Lg(e.data)[1][0].data)!=E});var a=r[3].findIndex(function(e){var r,t;var a=Lg(e.data);if((r=a[3])==null?void 0:r[0])return Sg(a[3][0].data)==d;if(((t=a[2])==null?void 0:t[0])&&Sg(a[2][0].data)==d)return true;return false});var n=Lg(r[3][a].data);if(!n[6])n[6]=[];n[6]=n[6].filter(function(e){return Ng(Lg(e.data)[1][0].data)!=E});r[3][a].data=Mg(n);e.messages[0].data=Mg(r)})}k[1]=[];var S=Math.ceil((l.e.r+1)/T);for(var _=0;_<S;++_){var A=ow({deps:[],location:"",type:6002},r);r[A].location="Root Entry/Index/Tables/Tile-".concat(A,".iwa");var x=[[],[{type:0,data:Ig(0)}],[{type:0,data:Ig(Math.min(l.e.r+1,(_+1)*T))}],[{type:0,data:Ig(0)}],[{type:0,data:Ig(Math.min((_+1)*T,l.e.r+1)-_*T)}],[],[{type:0,data:Ig(5)}],[{type:0,data:Ig(1)}],[{type:0,data:Ig(pw?1:0)}]];for(var C=_*T;C<=Math.min(l.e.r,(_+1)*T-1);++C){var O=[[],[{type:0,data:Ig(0)}],[{type:0,data:Ig(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ig(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ig(1)}]];fw(O,c[C],u,pw);O[1][0].data=Ig(C-_*T);x[5].push({data:Mg(O),type:2})}k[1].push({type:2,data:Mg([[],[{type:0,data:Ig(_)}],[{type:2,data:qg(A)}]])});var R={id:A,messages:[lw(6002,Mg(x))]};var N=Vg(Wg([R]));er.utils.cfb_add(e,"/Index/Tables/Tile-".concat(A,".iwa"),N);hw(e,r,2,function(e){var r=Lg(e.messages[0].data);r[3].push({type:2,data:Mg([[],[{type:0,data:Ig(A)}],[{type:2,data:_g("Tables/Tile")}],[{type:2,data:_g("Tables/Tile-".concat(A))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ig(0)}],[],[{type:0,data:Ig(y)}]])});r[1]=[{type:0,data:Ig(Math.max(A+1,Ng(r[1][0].data)))}];var t=r[3].findIndex(function(e){var r,t;var a=Lg(e.data);if((r=a[3])==null?void 0:r[0])return Sg(a[3][0].data)==d;if(((t=a[2])==null?void 0:t[0])&&Sg(a[2][0].data)==d)return true;return false});var a=Lg(r[3][t].data);if(!a[6])a[6]=[];a[6].push({type:2,data:Mg([[],[{type:0,data:Ig(A)}]])});r[3][t].data=Mg(a);e.messages[0].data=Mg(r)});var I=((s=a.messages[0].meta[5])==null?void 0:s[0])?Fg(a.messages[0].meta[5][0].data):[];var F=I.indexOf(A);if(F==-1){I[F=I.length]=A;a.messages[0].meta[5]=[{type:2,data:Dg(I)}]}w[1].push({type:2,data:Mg([[],[{type:0,data:Ig(_*T)}],[{type:0,data:Ig(_)}]])})}}p[3][0].data=Mg(k);p[9][0].data=Mg(w);p[10]=[{type:2,data:new Uint8Array([])}];if(t["!merges"]){var D=ow({type:6144,deps:[i],location:r[i].location},r);n.push({id:D,messages:[lw(6144,Mg([[],t["!merges"].map(function(e){return{type:2,data:Mg([[],[{type:2,data:Mg([[],[{type:5,data:new Uint8Array(new Uint16Array([e.s.r,e.s.c]).buffer)}]])}],[{type:2,data:Mg([[],[{type:5,data:new Uint8Array(new Uint16Array([e.e.r-e.s.r+1,e.e.c-e.s.c+1]).buffer)}]])}]])}})]))]});p[13]=[{type:2,data:qg(D)}];hw(e,r,2,function(e){var r=Lg(e.messages[0].data);var t=r[3].findIndex(function(e){var r,t;var a=Lg(e.data);if((r=a[3])==null?void 0:r[0])return Sg(a[3][0].data)==d;if(((t=a[2])==null?void 0:t[0])&&Sg(a[2][0].data)==d)return true;return false});var a=Lg(r[3][t].data);if(!a[6])a[6]=[];a[6].push({type:2,data:Mg([[],[{type:0,data:Ig(D)}]])});r[3][t].data=Mg(a);e.messages[0].data=Mg(r)});I=((f=a.messages[0].meta[5])==null?void 0:f[0])?Fg(a.messages[0].meta[5][0].data):[];F=I.indexOf(D);if(F==-1){I[F=I.length]=D;a.messages[0].meta[5]=[{type:2,data:Dg(I)}]}}else delete p[13]}v[4][0].data=Mg(p)}a.messages[0].data=Mg(v)}