function j2(e,t){var r=e.signatures.x509;Do.object(r,"x509 signature"),t.startSequence(),t.startSequence(Wa(0)),t.writeInt(2),t.endSequence(),t.writeBuffer(wI.mpNormalize(e.serial),fr.Ber.Integer),t.startSequence(),t.writeOID(Gs[r.algo]),r.algo.match(/^rsa-/)&&t.writeNull(),t.endSequence(),e.issuer.toAsn1(t),t.startSequence(),_I(t,e.validFrom),_I(t,e.validUntil),t.endSequence();var i=e.subjects[0],a=e.subjects.slice(1);if(i.toAsn1(t),SI.writePkcs8(t,e.subjectKey),r.extras&&r.extras.issuerUniqueID&&t.writeBuffer(r.extras.issuerUniqueID,Wa(1)),r.extras&&r.extras.subjectUniqueID&&t.writeBuffer(r.extras.subjectUniqueID,Wa(2)),a.length>0||i.type==="host"||e.purposes!==void 0&&e.purposes.length>0||r.extras&&r.extras.exts){t.startSequence(Wa(3)),t.startSequence();var n=[];e.purposes!==void 0&&e.purposes.length>0&&(n.push({oid:ss.basicConstraints,critical:!0}),n.push({oid:ss.keyUsage,critical:!0}),n.push({oid:ss.extKeyUsage,critical:!0})),n.push({oid:ss.altName}),r.extras&&r.extras.exts&&(n=r.extras.exts);for(var s=0;s<n.length;++s){if(t.startSequence(),t.writeOID(n[s].oid),n[s].critical!==void 0&&t.writeBoolean(n[s].critical),n[s].oid===ss.altName){t.startSequence(fr.Ber.OctetString),t.startSequence(),i.type==="host"&&t.writeString(i.hostname,od(2));for(var o=0;o<a.length;++o)a[o].type==="host"?t.writeString(a[o].hostname,Hn.DNSName):a[o].type==="email"?t.writeString(a[o].email,Hn.RFC822Name):(t.startSequence(Hn.DirectoryName),a[o].toAsn1(t),t.endSequence());t.endSequence(),t.endSequence()}else if(n[s].oid===ss.basicConstraints){t.startSequence(fr.Ber.OctetString),t.startSequence();var u=e.purposes.indexOf("ca")!==-1,l=n[s].pathLen;t.writeBoolean(u),l!==void 0&&t.writeInt(l),t.endSequence(),t.endSequence()}else if(n[s].oid===ss.extKeyUsage)t.startSequence(fr.Ber.OctetString),t.startSequence(),e.purposes.forEach(function(c){if(c!=="ca"&&c9.indexOf(c)===-1){var d=c;N2[c]!==void 0&&(d=N2[c]),t.writeOID(d)}}),t.endSequence(),t.endSequence();else if(n[s].oid===ss.keyUsage){if(t.startSequence(fr.Ber.OctetString),n[s].bits!==void 0)t.writeBuffer(n[s].bits,fr.Ber.BitString);else{var p=xfe(e.purposes,c9);t.writeBuffer(p,fr.Ber.BitString)}t.endSequence()}else t.writeBuffer(n[s].data,fr.Ber.OctetString);t.endSequence()}t.endSequence(),t.endSequence()}t.endSequence()}