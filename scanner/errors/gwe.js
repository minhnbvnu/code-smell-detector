function gwe(e){var t;let{buffer:r,nodeSet:n,maxBufferLength:i=hle,reused:a=[],minRepeatType:l=n.types.length}=e,s=Array.isArray(r)?new xI(r,r.length):r,u=n.types,c=0,d=0;function f(k,C,A,E,M,D){let{id:T,start:B,end:R,size:_}=s,V=d;for(;_<0;)if(s.next(),_==-1){let F=a[T];A.push(F),E.push(B-k);return}else if(_==-3){c=T;return}else if(_==-4){d=T;return}else throw new RangeError(`Unrecognized record size: ${_}`);let W=u[T],Z,K,q=B-k;if(R-B<=i&&(K=b(s.pos-C,M))){let F=new Uint16Array(K.size-K.skip),j=s.pos-K.size,Q=F.length;for(;s.pos>j;)Q=v(K.start,F,Q);Z=new Es(F,R-K.start,n),q=K.start-k}else{let F=s.pos-_;s.next();let j=[],Q=[],I=T>=l?T:-1,U=0,ee=R;for(;s.pos>F;)I>=0&&s.id==I&&s.size>=0?(s.end<=ee-i&&(m(j,Q,B,U,s.end,ee,I,V),U=j.length,ee=s.end),s.next()):D>2500?h(B,F,j,Q):f(B,F,j,Q,I,D+1);if(I>=0&&U>0&&U<j.length&&m(j,Q,B,U,B,ee,I,V),j.reverse(),Q.reverse(),I>-1&&U>0){let ue=p(W);Z=wI(W,j,Q,0,j.length,0,R-B,ue,ue)}else Z=g(W,j,Q,R-B,V-R)}A.push(Z),E.push(q)}function h(k,C,A,E){let M=[],D=0,T=-1;for(;s.pos>C;){let{id:B,start:R,end:_,size:V}=s;if(V>4)s.next();else{if(T>-1&&R<T)break;T<0&&(T=_-i),M.push(B,R,_),D++,s.next()}}if(D){let B=new Uint16Array(D*4),R=M[M.length-2];for(let _=M.length-3,V=0;_>=0;_-=3)B[V++]=M[_],B[V++]=M[_+1]-R,B[V++]=M[_+2]-R,B[V++]=V;A.push(new Es(B,M[2]-R,n)),E.push(R-k)}}function p(k){return(C,A,E)=>{let M=0,D=C.length-1,T,B;if(D>=0&&(T=C[D])instanceof Qr){if(!D&&T.type==k&&T.length==E)return T;(B=T.prop(kt.lookAhead))&&(M=A[D]+T.length+B)}return g(k,C,A,E,M)}}function m(k,C,A,E,M,D,T,B){let R=[],_=[];for(;k.length>E;)R.push(k.pop()),_.push(C.pop()+A-M);k.push(g(n.types[T],R,_,D-M,B-D)),C.push(M-A)}function g(k,C,A,E,M=0,D){if(c){let T=[kt.contextHash,c];D=D?[T].concat(D):[T]}if(M>25){let T=[kt.lookAhead,M];D=D?[T].concat(D):[T]}return new Qr(k,C,A,E,D)}function b(k,C){let A=s.fork(),E=0,M=0,D=0,T=A.end-i,B={size:0,start:0,skip:0};e:for(let R=A.pos-k;A.pos>R;){let _=A.size;if(A.id==C&&_>=0){B.size=E,B.start=M,B.skip=D,D+=4,E+=4,A.next();continue}let V=A.pos-_;if(_<0||V<R||A.start<T)break;let W=A.id>=l?4:0,Z=A.start;for(A.next();A.pos>V;){if(A.size<0)if(A.size==-3)W+=4;else break e;else A.id>=l&&(W+=4);A.next()}M=Z,E+=_,D+=W}return(C<0||E==k)&&(B.size=E,B.start=M,B.skip=D),B.size>4?B:void 0}function v(k,C,A){let{id:E,start:M,end:D,size:T}=s;if(s.next(),T>=0&&E<l){let B=A;if(T>4){let R=s.pos-(T-4);for(;s.pos>R;)A=v(k,C,A)}C[--A]=B,C[--A]=D-k,C[--A]=M-k,C[--A]=E}else T==-3?c=E:T==-4&&(d=E);return A}let y=[],$=[];for(;s.pos>0;)f(e.start||0,e.bufferStart||0,y,$,-1,0);let x=(t=e.length)!==null&&t!==void 0?t:y.length?$[0]+y[0].length:0;return new Qr(u[e.topID],y.reverse(),$.reverse(),x)}