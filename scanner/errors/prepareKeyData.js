function prepareKeyData(r,o,c,l,u,g,y,m){var v,w,_=40+c.length+r.length,k=new Uint8Array(_),S=0;if(o){w=Math.min(32,o.length);for(;S<w;++S)k[S]=o[S]}v=0;for(;S<32;)k[S++]=t[v++];for(v=0,w=c.length;v<w;++v)k[S++]=c[v];k[S++]=255&u;k[S++]=u>>8&255;k[S++]=u>>16&255;k[S++]=u>>>24&255;for(v=0,w=r.length;v<w;++v)k[S++]=r[v];if(g>=4&&!m){k[S++]=255;k[S++]=255;k[S++]=255;k[S++]=255}var C=d(k,0,S),x=y>>3;if(g>=3)for(v=0;v<50;++v)C=d(C,0,x);var O,T=C.subarray(0,x);if(g>=3){for(S=0;S<32;++S)k[S]=t[S];for(v=0,w=r.length;v<w;++v)k[S++]=r[v];O=new h(T).encryptBlock(d(k,0,S));w=T.length;var E=new Uint8Array(w);for(v=1;v<=19;++v){for(var M=0;M<w;++M)E[M]=T[M]^v;O=new h(E).encryptBlock(O)}for(v=0,w=O.length;v<w;++v)if(l[v]!==O[v])return null}else for(v=0,w=(O=new h(T).encryptBlock(t)).length;v<w;++v)if(l[v]!==O[v])return null;return T}