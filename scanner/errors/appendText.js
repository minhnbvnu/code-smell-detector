function appendText(t,r,a,o){var d=document.createElement("span"),h=t._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==r.str,hasEOL:r.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:""!==r.str,hasEOL:r.hasEOL,fontSize:0};t._textDivs.push(d);var p=i.Util.transform(t._viewport.transform,r.transform),v=Math.atan2(p[1],p[0]),y=a[r.fontName];y.vertical&&(v+=Math.PI/2);var g,_,m=Math.hypot(p[2],p[3]),b=m*function getAscent(t,r){var a=c.get(t);if(a)return a;r.save();r.font="".concat(l,"px ").concat(t);var i=r.measureText(""),o=i.fontBoundingBoxAscent,u=Math.abs(i.fontBoundingBoxDescent);if(o){r.restore();var d=o/(o+u);c.set(t,d);return d}r.strokeStyle="red";r.clearRect(0,0,l,l);r.strokeText("g",0,0);var h=r.getImageData(0,0,l,l).data;u=0;for(var p=h.length-1-3;p>=0;p-=4)if(h[p]>0){u=Math.ceil(p/4/l);break}r.clearRect(0,0,l,l);r.strokeText("A",0,l);o=0;for(var v=0,y=(h=r.getImageData(0,0,l,l).data).length;v<y;v+=4)if(h[v]>0){o=l-Math.floor(v/4/l);break}r.restore();if(o){var g=o/(o+u);c.set(t,g);return g}c.set(t,.8);return.8}(y.fontFamily,o);if(0===v){g=p[4];_=p[5]-b}else{g=p[4]+b*Math.sin(v);_=p[5]-b*Math.cos(v)}d.style.left="".concat(g,"px");d.style.top="".concat(_,"px");d.style.fontSize="".concat(m,"px");d.style.fontFamily=y.fontFamily;h.fontSize=m;d.setAttribute("role","presentation");d.textContent=r.str;d.dir=r.dir;t._fontInspectorEnabled&&(d.dataset.fontName=r.fontName);0!==v&&(h.angle=v*(180/Math.PI));var A=!1;if(r.str.length>1||t._enhanceTextSelection&&u.test(r.str))A=!0;else if(" "!==r.str&&r.transform[0]!==r.transform[3]){var k=Math.abs(r.transform[0]),P=Math.abs(r.transform[3]);k!==P&&Math.max(k,P)/Math.min(k,P)>1.5&&(A=!0)}A&&(y.vertical?h.canvasWidth=r.height*t._viewport.scale:h.canvasWidth=r.width*t._viewport.scale);t._textDivProperties.set(d,h);t._textContentStream&&t._layoutText(d);if(t._enhanceTextSelection&&h.hasText){var S=1,w=0;if(0!==v){S=Math.cos(v);w=Math.sin(v)}var x,C,T=(y.vertical?r.height:r.width)*t._viewport.scale,E=m;if(0!==v){x=[S,w,-w,S,g,_];C=i.Util.getAxialAlignedBoundingBox([0,0,T,E],x)}else C=[g,_,g+T,_+E];t._bounds.push({left:C[0],top:C[1],right:C[2],bottom:C[3],div:d,size:[T,E],m:x})}}