function xw(e,r){if(e&&!e.SSF){e.SSF=yr(Z)}if(e&&e.SSF){$e();Ge(e.SSF);r.revssf=or(e.SSF);r.revssf[e.SSF[65535]]=0;r.ssf=e.SSF}r.rels={};r.wbrels={};r.Strings=[];r.Strings.Count=0;r.Strings.Unique=0;if(qd)r.revStrings=new Map;else{r.revStrings={};r.revStrings.foo=[];delete r.revStrings.foo}var t="xml";var a=Nu.indexOf(r.bookType)>-1;var n=ti();ww(r=r||{});var i=Hr();var s="",f=0;r.cellXfs=[];tv(r.cellXfs,{},{revssf:{General:0}});if(!e.Props)e.Props={};s="docProps/core.xml";Wr(i,s,Ti(e.Props,r));n.coreprops.push(s);oi(r.rels,2,s,ii.CORE_PROPS);s="docProps/app.xml";if(e.Props&&e.Props.SheetNames){}else if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{var l=[];for(var o=0;o<e.SheetNames.length;++o)if((e.Workbook.Sheets[o]||{}).Hidden!=2)l.push(e.SheetNames[o]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length;Wr(i,s,Ai(e.Props,r));n.extprops.push(s);oi(r.rels,3,s,ii.EXT_PROPS);if(e.Custprops!==e.Props&&sr(e.Custprops||{}).length>0){s="docProps/custom.xml";Wr(i,s,Oi(e.Custprops,r));n.custprops.push(s);oi(r.rels,4,s,ii.CUST_PROPS)}var c=["SheetJ5"];r.tcid=0;for(f=1;f<=e.SheetNames.length;++f){var u={"!id":{}};var h=e.Sheets[e.SheetNames[f-1]];var d=(h||{})["!type"]||"sheet";switch(d){case"chart":;default:s="xl/worksheets/sheet"+f+"."+t;Wr(i,s,Mv(f-1,r,e,u));n.sheets.push(s);oi(r.wbrels,-1,"worksheets/sheet"+f+"."+t,ii.WS[0]);}if(h){var v=h["!comments"];var p=false;var m="";if(v&&v.length>0){var b=false;v.forEach(function(e){e[1].forEach(function(e){if(e.T==true)b=true})});if(b){m="xl/threadedComments/threadedComment"+f+".xml";Wr(i,m,wu(v,c,r));n.threadedcomments.push(m);oi(u,-1,"../threadedComments/threadedComment"+f+".xml",ii.TCMNT)}m="xl/comments"+f+"."+t;Wr(i,m,bu(v,r));n.comments.push(m);oi(u,-1,"../comments"+f+"."+t,ii.CMNT);p=true}if(h["!legacy"]){if(p)Wr(i,"xl/drawings/vmlDrawing"+f+".vml",du(f,h["!comments"]))}delete h["!comments"];delete h["!legacy"]}if(u["!id"].rId1)Wr(i,si(s),li(u))}if(r.Strings!=null&&r.Strings.length>0){s="xl/sharedStrings."+t;Wr(i,s,Xl(r.Strings,r));n.strs.push(s);oi(r.wbrels,-1,"sharedStrings."+t,ii.SST)}s="xl/workbook."+t;Wr(i,s,Tm(e,r));n.workbooks.push(s);oi(r.rels,1,s,ii.WB);s="xl/theme/theme1.xml";Wr(i,s,Hc(e.Themes,r));n.themes.push(s);oi(r.wbrels,-1,"theme/theme1.xml",ii.THEME);s="xl/styles."+t;Wr(i,s,ac(e,r));n.styles.push(s);oi(r.wbrels,-1,"styles."+t,ii.STY);if(e.vbaraw&&a){s="xl/vbaProject.bin";Wr(i,s,e.vbaraw);n.vba.push(s);oi(r.wbrels,-1,"vbaProject.bin",ii.VBA)}s="xl/metadata."+t;Wr(i,s,su());n.metadata.push(s);oi(r.wbrels,-1,"metadata."+t,ii.XLMETA);if(c.length>1){s="xl/persons/person.xml";Wr(i,s,Tu(c,r));n.people.push(s);oi(r.wbrels,-1,"persons/person.xml",ii.PEOPLE)}Wr(i,"[Content_Types].xml",ni(n,r));Wr(i,"_rels/.rels",li(r.rels));Wr(i,"xl/_rels/workbook."+t+".rels",li(r.wbrels));delete r.revssf;delete r.ssf;return i}